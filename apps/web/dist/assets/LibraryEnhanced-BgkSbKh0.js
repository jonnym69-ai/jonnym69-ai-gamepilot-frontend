import{r as g,j as e,u as T,m as E,e as $,E as z,f as F,A as U}from"./index-2zxZw9Mw.js";import{u as A,G as B,c as O,n as H}from"./useLibraryStore-BvHGHpT8.js";import{M as W}from"./masterMoods-YBYEbnnW.js";import{u as K,p as _,g as q}from"./gameImageUtils-GAIUb6EE.js";const D=[{id:"Intense",name:"Intense",description:"High-pressure, competitive, fast-paced gameplay",emoji:"ðŸ”¥",icon:"âš¡",color:"from-red-500 to-orange-600",intensity:9,associatedGenres:["action","fps","multiplayer"]},{id:"Strategic",name:"Strategic",description:"Requires planning, tactics, careful decision-making",emoji:"ðŸ§ ",icon:"â™Ÿï¸",color:"from-blue-500 to-indigo-600",intensity:7,associatedGenres:["strategy","puzzle","rpg"]},{id:"Relaxing",name:"Relaxing",description:"Low-stress, peaceful, zen-like gameplay",emoji:"ðŸ˜Œ",icon:"ðŸŒŠ",color:"from-blue-400 to-cyan-500",intensity:2,associatedGenres:["casual","simulation","puzzle"]},{id:"Creative",name:"Creative",description:"Building, crafting, expression, customization",emoji:"ðŸŽ¨",icon:"ðŸŽ­",color:"from-green-500 to-emerald-600",intensity:6,associatedGenres:["simulation","casual","puzzle"]},{id:"High-Energy",name:"High-Energy",description:"Action-packed, exciting, adrenaline-fueled",emoji:"âš¡",icon:"ðŸš€",color:"from-yellow-500 to-amber-600",intensity:8,associatedGenres:["action","racing","sports"]},{id:"Atmospheric",name:"Atmospheric",description:"Immersive world-building, exploration, mood-setting",emoji:"ðŸŒ«",icon:"ðŸŒ ",color:"from-gray-500 to-slate-600",intensity:4,associatedGenres:["adventure","horror","rpg"]},{id:"Challenging",name:"Challenging",description:"Difficult, requires skill, punishing gameplay",emoji:"ðŸ†",icon:"âš”ï¸",color:"from-purple-500 to-pink-600",intensity:8,associatedGenres:["strategy","action","rpg"]},{id:"Story-Rich",name:"Story-Rich",description:"Narrative-driven, plot-heavy, story-focused",emoji:"ðŸ“š",icon:"ðŸ“–",color:"from-indigo-500 to-purple-600",intensity:6,associatedGenres:["rpg","adventure","narrative"]},{id:"Competitive",name:"Competitive",description:"Competition-focused, achievement-driven, versus play",emoji:"ðŸ†",icon:"ðŸ”¥",color:"from-red-500 to-orange-600",intensity:9,associatedGenres:["action","sports","multiplayer"]},{id:"Social",name:"Social",description:"Multiplayer, community, cooperative gameplay",emoji:"ðŸ‘¥",icon:"ðŸ¤",color:"from-teal-500 to-cyan-600",intensity:5,associatedGenres:["multiplayer","casual","party"]},{id:"Experimental",name:"Experimental",description:"Innovative, boundary-pushing, unique mechanics",emoji:"ðŸ§ª",icon:"âš—ï¸",color:"from-pink-500 to-rose-600",intensity:7,associatedGenres:["indie","puzzle","simulation"]},{id:"Mindful",name:"Mindful",description:"Thoughtful, deliberate, contemplative gameplay",emoji:"ðŸ§˜",icon:"ðŸ§ ",color:"from-purple-500 to-indigo-600",intensity:3,associatedGenres:["puzzle","strategy","meditation"]},{id:"Nostalgic",name:"Nostalgic",description:"Retro-inspired, classic, timeless appeal",emoji:"ðŸ•°",icon:"ðŸŽ®",color:"from-amber-500 to-yellow-600",intensity:4,associatedGenres:["retro","classic","arcade"]},{id:"Gritty",name:"Gritty",description:"Tough, demanding, perseverance-testing",emoji:"ðŸ’ª",icon:"ðŸ›¡ï¸",color:"from-gray-500 to-slate-600",intensity:8,associatedGenres:["strategy","survival","hardcore"]},{id:"Surreal",name:"Surreal",description:"Dream-like, abstract, mind-bending",emoji:"ðŸŒŒ",icon:"ðŸŽ­",color:"from-purple-500 to-pink-600",intensity:7,associatedGenres:["puzzle","art","experimental"]},{id:"Action-Packed",name:"Action-Packed",description:"Non-stop action, constant excitement, thrilling",emoji:"âš¡",icon:"ðŸš€",color:"from-red-500 to-orange-600",intensity:10,associatedGenres:["action","shooter","adventure"]},{id:"Dark",name:"Dark",description:"Mature themes, horror elements, intense atmosphere",emoji:"ðŸŒ‘",icon:"ðŸ’€",color:"from-black to-gray-600",intensity:8,associatedGenres:["horror","action","adventure"]},{id:"Humorous",name:"Humorous",description:"Comedic, lighthearted, entertaining gameplay",emoji:"ðŸ˜‚",icon:"ðŸ¤£",color:"from-yellow-500 to-orange-600",intensity:4,associatedGenres:["comedy","casual","party"]},{id:"Educational",name:"Educational",description:"Learning-focused, informative, skill-building",emoji:"ðŸ“š",icon:"ðŸŽ“",color:"from-blue-500 to-indigo-600",intensity:5,associatedGenres:["educational","puzzle","strategy"]},{id:"Retro",name:"Retro",description:"Classic gameplay, nostalgic feel, old-school charm",emoji:"ðŸ•¹ï¸",icon:"ðŸ‘¾",color:"from-green-500 to-emerald-600",intensity:6,associatedGenres:["retro","classic","arcade"]},{id:"Open-World",name:"Open-World",description:"Exploration-focused, sandbox gameplay, freedom",emoji:"ðŸŒ",icon:"ðŸ—ºï¸",color:"from-blue-500 to-indigo-600",intensity:7,associatedGenres:["open-world","adventure","rpg"]},{id:"Cooperative",name:"Cooperative",description:"Multiplayer, teamwork, cooperative gameplay",emoji:"ðŸ‘«",icon:"ðŸ¤",color:"from-teal-500 to-cyan-600",intensity:5,associatedGenres:["multiplayer","cooperative","party"]},{id:"Fast-Paced",name:"Fast-Paced",description:"Quick reflexes, rapid action, thrilling gameplay",emoji:"âš¡",icon:"ðŸŽï¸",color:"from-red-500 to-orange-600",intensity:9,associatedGenres:["action","racing","sports"]},{id:"Immersive",name:"Immersive",description:"Engaging storyline, interactive gameplay, immersive atmosphere",emoji:"ðŸ“º",icon:"ðŸŽ¬",color:"from-purple-500 to-pink-600",intensity:8,associatedGenres:["adventure","rpg","narrative"]},{id:"Casual",name:"Casual",description:"Easy to play, relaxing, laid-back gameplay",emoji:"ðŸ˜Š",icon:"ðŸ‘Œ",color:"from-green-500 to-emerald-600",intensity:3,associatedGenres:["casual","puzzle","simulation"]},{id:"Scary",name:"Scary",description:"Horror-filled, terrifying, spine-chilling gameplay",emoji:"ðŸ˜±",icon:"ðŸ‘»",color:"from-gray-900 to-black",intensity:10,associatedGenres:["horror","survival","thriller"]}],V=[{id:"cozy",name:"Cozy",category:"gameplay",description:"Comforting and relaxing gameplay",color:"text-amber-400"},{id:"sweaty",name:"Sweaty",category:"gameplay",description:"Intense and challenging gameplay",color:"text-red-400"},{id:"story-heavy",name:"Story-Heavy",category:"gameplay",description:"Rich narrative focus",color:"text-purple-400"},{id:"sandbox",name:"Sandbox",category:"gameplay",description:"Open-ended creative freedom",color:"text-green-400"},{id:"roguelike",name:"Roguelike",category:"gameplay",description:"Procedural generation with permadeath",color:"text-orange-400"},{id:"turn-based",name:"Turn-Based",category:"gameplay",description:"Strategic, non-real-time gameplay",color:"text-blue-400"},{id:"real-time",name:"Real-Time",category:"gameplay",description:"Continuous action gameplay",color:"text-red-500"},{id:"pixel-perfect",name:"Pixel-Perfect",category:"gameplay",description:"Precise platforming or controls",color:"text-pink-400"},{id:"atmospheric",name:"Atmospheric",category:"atmosphere",description:"Immersive and mood-setting",color:"text-indigo-400"},{id:"relaxing",name:"Relaxing",category:"atmosphere",description:"Calming and stress-free",color:"text-cyan-400"},{id:"intense",name:"Intense",category:"atmosphere",description:"High-stakes and exciting",color:"text-red-600"},{id:"mysterious",name:"Mysterious",category:"atmosphere",description:"Intriguing and enigmatic",color:"text-purple-600"},{id:"wholesome",name:"Wholesome",category:"atmosphere",description:"Heartwarming and positive",color:"text-pink-300"},{id:"dark",name:"Dark",category:"atmosphere",description:"Mature and serious themes",color:"text-gray-600"},{id:"easy",name:"Easy",category:"difficulty",description:"Accessible and forgiving",color:"text-green-500"},{id:"challenging",name:"Challenging",category:"difficulty",description:"Tests player skills",color:"text-orange-500"},{id:"brutal",name:"Brutal",category:"difficulty",description:"Extremely difficult",color:"text-red-700"},{id:"single-player",name:"Single-Player",category:"social",description:"Solo gaming experience",color:"text-blue-500"},{id:"co-op",name:"Co-op",category:"social",description:"Cooperative multiplayer",color:"text-teal-500"},{id:"pvp",name:"PvP",category:"social",description:"Player versus player",color:"text-red-500"},{id:"community-driven",name:"Community-Driven",category:"social",description:"Relies on player community",color:"text-purple-500"},{id:"fantasy",name:"Fantasy",category:"theme",description:"Magic and mythical settings",color:"text-purple-400"},{id:"sci-fi",name:"Sci-Fi",category:"theme",description:"Science fiction settings",color:"text-cyan-400"},{id:"modern",name:"Modern",category:"theme",description:"Contemporary settings",color:"text-gray-400"},{id:"historical",name:"Historical",category:"theme",description:"Historical periods",color:"text-amber-600"},{id:"post-apocalyptic",name:"Post-Apocalyptic",category:"theme",description:"End-of-world scenarios",color:"text-gray-700"},{id:"backlog",name:"Backlog",category:"gameplay",description:"Games to play later",color:"text-yellow-400"}];function Y({src:t,alt:a,className:r="",onLoad:m,onError:h,sizes:l="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",webpSrc:d,avifSrc:x,priority:p=!1}){const[y,N]=g.useState(!1),[S,s]=g.useState(p),[n,o]=g.useState(!1),f=g.useRef(null),i=Q(),u=J(),{observe:I,unobserve:c}=K(j=>{j.forEach(w=>{w.isIntersecting&&(s(!0),f.current&&c(f.current))})},{threshold:.1,rootMargin:"50px"});g.useEffect(()=>(!p&&f.current&&I(f.current),()=>{!p&&f.current&&c(f.current)}),[I,c,p]);const k=()=>{N(!0),m?.()},G=()=>{o(!0),h?.()};g.useEffect(()=>{S&&!n&&_(x&&u?x:d&&i?d:t).then(k).catch(G)},[S,t,d,x,i,u,n]);const v=j=>!j.includes("cdn")&&!j.includes("steam")?j:[256,512,1024].map(b=>`${j}?w=${b} ${b}w`).join(", ");return e.jsxs("div",{ref:f,className:`relative aspect-square overflow-hidden ${r}`,children:[e.jsxs("div",{className:`
          absolute inset-0 bg-gradient-to-br from-gray-800 via-gray-900 to-black
          flex items-center justify-center transition-all duration-500
          ${y?"opacity-0 scale-95":"opacity-100 scale-100"}
        `,children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"text-4xl text-gray-600 animate-pulse",children:"ðŸŽ®"}),e.jsx("div",{className:"absolute inset-0 blur-lg bg-gaming-primary/10 scale-150"})]}),e.jsx("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center",children:e.jsx("div",{className:"w-8 h-1 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-gaming-primary to-gaming-secondary rounded-full animate-pulse"})})})]}),S&&!n&&e.jsxs("picture",{className:"absolute inset-0 w-full h-full",children:[x&&u&&e.jsx("source",{srcSet:v(x),sizes:l,type:"image/avif"}),d&&i&&e.jsx("source",{srcSet:v(d),sizes:l,type:"image/webp"}),e.jsx("img",{src:t,srcSet:v(t),sizes:l,alt:a,className:`
              absolute inset-0 w-full h-full object-center transition-opacity duration-500 optimized-image
              ${y?"opacity-100":"opacity-0"}
            `,onLoad:()=>N(!0),onError:()=>o(!0),loading:p?"eager":"lazy",decoding:"async"})]}),n&&e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-br from-red-900/30 via-red-800/20 to-red-900/30 flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"text-3xl text-red-500",children:"ðŸš«"}),e.jsx("div",{className:"absolute inset-0 blur-lg bg-red-500/10 scale-150"})]}),e.jsx("span",{className:"text-xs text-red-400 mt-2 font-medium",children:"Failed to load"})]}),y&&!n&&e.jsx("div",{className:"absolute inset-0 opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/10 to-transparent"})})]})}function Q(){const[t,a]=g.useState(!1);return g.useEffect(()=>{const r=document.createElement("canvas");r.width=1,r.height=1;const m=r.getContext("2d");m&&(m.fillStyle="rgba(0,0,0,0.5)",m.fillRect(0,0,1,1),r.toBlob(h=>{a(h?.type==="image/webp")},"image/webp"))},[]),t}function J(){const[t,a]=g.useState(!1);return g.useEffect(()=>{const r=document.createElement("canvas");r.width=1,r.height=1;const m=r.getContext("2d");m&&(m.fillStyle="rgba(0,0,0,0.5)",m.fillRect(0,0,1,1),r.toBlob(h=>{a(h?.type==="image/avif")},"image/avif"))},[]),t}function X(t){if(!t)return"chill";if(t.mood&&typeof t.mood=="string"){const a=t.mood.toLowerCase();if(["chill","competitive","story","creative","social","focused","energetic","exploratory"].includes(a))return a}if(t.moods&&Array.isArray(t.moods)){const a=t.moods.filter(r=>typeof r=="string"&&["chill","competitive","story","creative","social","focused","energetic","exploratory"].includes(r.toLowerCase()));if(a.length>0)return a[0]}return"chill"}function Z({game:t,isSelected:a,isSelectable:r,onSelect:m,currentSession:h,onLaunch:l,onDelete:d,onEdit:x,recommendationScore:p}){const y=T(),{actions:N}=A(),[S,s]=g.useState(!1),[n,o]=g.useState(!1),[f,i]=g.useState(!1);g.useEffect(()=>{o(h?.gameId===t.id)},[h,t.id]);const u=()=>{y(`/library/game/${t.id}`)},I=async()=>{if(!(f||!l)){i(!0);try{await l(t)}finally{i(!1)}}},c=async()=>{h&&await N.endGameSession(h.gameId)},k=w=>{switch(w){case"playing":return"ðŸŽ®";case"completed":return"âœ…";case"backlog":return"ðŸ“š";case"abandoned":return"ðŸš«";default:return"ðŸ“‹"}},G=w=>{const b="px-2 py-1 rounded-full text-[10px] font-black uppercase tracking-wider text-white shadow-lg backdrop-blur-md border";switch(w){case"playing":return`${b} bg-green-500/40 border-green-400/30`;case"completed":return`${b} bg-blue-500/40 border-blue-400/30`;case"backlog":return`${b} bg-gray-500/40 border-gray-400/30 text-gray-200`;case"abandoned":return`${b} bg-red-500/40 border-red-400/30`;default:return`${b} bg-gray-500/40 border-gray-400/30`}},v=t.appId&&String(t.appId).trim()!=="",j=q(t);return console.log(`GameCard for ${t.title}: hasSteamAppId=${v}, appId=${t.appId}, imageUrl=${j}`),e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},whileHover:{scale:1.02,y:-5},className:`group relative bg-white/5 backdrop-blur-md rounded-2xl overflow-hidden border transition-all duration-300 cursor-pointer hover:z-50 hover:shadow-2xl hover:shadow-gaming-primary/20 ${a?"border-gaming-primary ring-2 ring-gaming-primary/50":"border-white/5 hover:border-white/10"}`,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:[r&&e.jsx(E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute top-4 left-4 z-20",children:e.jsx("input",{type:"checkbox",checked:a,onChange:w=>{w.stopPropagation(),m?.(t,w.target.checked)},className:"w-6 h-6 rounded-lg border-2 border-white/20 bg-black/40 text-gaming-primary focus:ring-gaming-primary focus:ring-offset-0 transition-all cursor-pointer","aria-label":`Select ${t.title}`})}),e.jsxs("div",{className:"relative w-full aspect-[3/4] overflow-hidden bg-gray-900 flex-shrink-0",children:[j?e.jsxs(e.Fragment,{children:[e.jsx(Y,{src:j,alt:t.title,className:"w-full h-full object-cover transition-all duration-700 group-hover:scale-110 group-hover:brightness-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gaming-dark via-transparent to-transparent opacity-60 group-hover:opacity-40 transition-opacity"})]}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-white/5 group-hover:bg-white/10 transition-colors",children:e.jsx("span",{className:"text-6xl grayscale group-hover:grayscale-0 transition-all duration-500 opacity-20 group-hover:opacity-40",children:"ðŸŽ®"})}),t.playStatus&&t.playStatus!=="backlog"&&e.jsx("div",{className:"absolute top-4 right-4 z-10",children:e.jsxs("div",{className:G(t.playStatus),children:[k(t.playStatus)," ",t.playStatus]})}),t.completionPercentage!==void 0&&t.completionPercentage>0&&e.jsx("div",{className:"absolute bottom-4 right-4 z-10 scale-75 md:scale-100",children:e.jsxs("div",{className:"relative w-12 h-12 bg-black/40 backdrop-blur-md rounded-full p-1 border border-white/10",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"20",cy:"20",r:"18",stroke:"currentColor",strokeWidth:"3",fill:"none",className:"text-white/10"}),e.jsx("circle",{cx:"20",cy:"20",r:"18",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:113,strokeDashoffset:113-113*t.completionPercentage/100,className:"text-gaming-primary transition-all duration-1000"})]}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-[10px] font-black text-white",children:[Math.round(t.completionPercentage),"%"]})]})})]}),e.jsxs("div",{className:"p-5 flex flex-col h-full bg-gradient-to-b from-transparent to-black/20",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-white font-gaming font-bold text-lg line-clamp-1 group-hover:text-gaming-primary transition-colors leading-tight mb-1",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.platforms?.[0]&&e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500",children:typeof t.platforms[0]=="string"?t.platforms[0]:t.platforms[0].name}),t.hoursPlayed!==void 0&&t.hoursPlayed>0&&e.jsxs("span",{className:"text-[10px] font-black text-gaming-accent",children:["â€¢ ",Math.floor(t.hoursPlayed),"H"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-auto",children:[p&&e.jsxs("div",{className:"w-full mt-2 p-2 bg-white/5 rounded-lg border border-white/5",children:[e.jsx("div",{className:"text-xs font-bold text-gaming-primary mb-1",children:p.reasoning.primary}),e.jsx("div",{className:"space-y-1",children:p.reasoning.secondary.map((w,b)=>e.jsxs("div",{className:"text-[10px] text-gray-400",children:["â€¢ ",w]},b))}),e.jsxs("div",{className:`text-[9px] font-bold mt-2 ${p.reasoning.confidence==="high"?"text-green-400":p.reasoning.confidence==="medium"?"text-yellow-400":"text-gray-500"}`,children:[p.reasoning.confidence==="high"&&"High confidence match",p.reasoning.confidence==="medium"&&"Good potential match",p.reasoning.confidence==="low"&&"Experimental suggestion"]})]}),(t.moods&&t.moods.length>0?t.moods:[X(t)]).slice(0,1).map(w=>{const b=D.find(C=>C.id===w);return b?e.jsxs("span",{className:"px-2.5 py-1 rounded-md bg-white/5 border border-white/5 text-[10px] font-bold text-gray-300 flex items-center gap-1.5 transition-colors group-hover:border-white/10",children:[e.jsx("span",{"aria-hidden":"true",children:b.emoji}),e.jsx("span",{className:"uppercase tracking-tighter",children:b.name})]},w):null}),t.genres?.[0]&&e.jsx("span",{className:"px-2.5 py-1 rounded-md bg-gaming-primary/10 border border-gaming-primary/20 text-[10px] font-bold text-gaming-primary uppercase tracking-tighter",children:typeof t.genres[0]=="string"?t.genres[0]:t.genres[0].name})]}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 p-4 bg-gradient-to-t from-gaming-dark to-transparent flex gap-2",children:[e.jsx("button",{onClick:w=>{w.stopPropagation(),u()},className:"flex-1 py-2.5 bg-white/10 hover:bg-white/20 text-white rounded-lg text-xs font-bold transition-all border border-white/10 backdrop-blur-md",children:"Details"}),v?e.jsx("button",{onClick:w=>{w.stopPropagation(),n?c():I()},disabled:f,className:`flex-1 py-2.5 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 border shadow-lg ${n?"bg-red-500/80 border-red-400/50 text-white":"bg-gaming-primary border-gaming-primary/50 text-white"}`,children:n?"â¹ Stop":f?"â³...":"â–¶ Play"}):e.jsx("div",{className:"flex-1 py-2.5 bg-gray-600 text-gray-400 rounded-lg text-xs font-bold flex items-center justify-center border border-gray-500",children:"No Steam App ID"})]})]})]})}class R{static BASE_URL="https://api.gog.com/v2";static SEARCH_URL="https://catalog.gog.com/v1/catalog";static async searchGames(a,r=10){try{const m=`${this.SEARCH_URL}?query=${encodeURIComponent(a)}&limit=${r}&productType=game&sortBy=popularity&order=desc`,h=await fetch(m,{headers:{Accept:"application/json","User-Agent":"GamePilot/1.0"}});if(!h.ok)throw new Error(`GOG API Error: ${h.status}`);const l=await h.json();return l.products?l.products.map(this.transformGOGGame):[]}catch(m){return console.error("GOG Search Error:",m),[]}}static async getGameDetails(a){try{const r=`${this.BASE_URL}/products/${a}`,m=await fetch(r,{headers:{Accept:"application/json","User-Agent":"GamePilot/1.0"}});if(!m.ok)throw new Error(`GOG API Error: ${m.status}`);const h=await m.json();return this.transformGOGGame(h)}catch(r){return console.error("GOG Game Details Error:",r),null}}static getGOGStoreUrl(a){return`https://www.gog.com/game/${a}`}static getGOGLauncherUrl(a){return`goggalaxy://openGame/${a}`}static transformGOGGame(a){return{id:a.id||a.slug,title:a.title||a.name,slug:a.slug,url:a.url||`https://www.gog.com/game/${a.slug}`,image:a.coverHorizontal||a.image||a.cover,price:a.price?.amount||"Free",developers:a.developers||[],genres:a.genres||[],platforms:a.platforms||[],releaseDate:a.releaseDate||a.release_date,description:a.description||a.summary||""}}static convertGOGGameToGame(a){return{title:a.title,launcherId:a.id,platforms:["GOG"],status:"backlog",playtime:0,coverImage:a.image,genres:a.genres,tags:[],achievements:{unlocked:0,total:0},description:a.description}}static extractGOGIdFromUrl(a){const r=a.match(/gog\.com\/game\/([^\/\?]+)/);return r?r[1]:null}static extractGOGIdFromStoreUrl(a){const r=a.match(/gog\.com\/en\/game\/([^\/\?]+)/);return r?r[1]:null}}class ee{static searchCache=new Map;static cacheTimeout=300*1e3;static async searchWithCache(a){const r=a.toLowerCase().trim();if(this.searchCache.has(r))return this.searchCache.get(r);const m=await R.searchGames(a);return this.searchCache.set(r,m),setTimeout(()=>{this.searchCache.delete(r)},this.cacheTimeout),m}static clearCache(){this.searchCache.clear()}}const te=({onGameSelect:t,placeholder:a="Search GOG games..."})=>{const[r,m]=g.useState(""),[h,l]=g.useState([]),[d,x]=g.useState(!1),[p,y]=g.useState(!1);g.useEffect(()=>{const n=setTimeout(async()=>{if(r.trim().length<2){l([]),y(!1);return}x(!0);try{const o=await ee.searchWithCache(r);l(o.slice(0,8)),y(!0)}catch(o){console.error("GOG search error:",o),l([])}finally{x(!1)}},300);return()=>clearTimeout(n)},[r]);const N=s=>{t(s),m(""),l([]),y(!1)},S=s=>{s.key==="Escape"&&y(!1)};return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:r,onChange:s=>m(s.target.value),onFocus:()=>r.trim().length>=2&&y(!0),onKeyDown:S,className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none",placeholder:a}),d&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gaming-accent"})})]}),p&&h.length>0&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg max-h-96 overflow-y-auto",children:h.map(s=>e.jsxs("div",{onClick:()=>N(s),className:"flex items-center gap-3 p-3 hover:bg-gray-700 cursor-pointer border-b border-gray-700 last:border-b-0",children:[e.jsx("img",{src:s.image,alt:s.title,className:"w-12 h-12 rounded object-cover",onError:n=>{n.currentTarget.src="https://via.placeholder.com/48x48/8b5cf6/ffffff?text=GOG"}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-white font-medium truncate",children:s.title}),e.jsx("p",{className:"text-gray-400 text-sm truncate",children:s.genres.slice(0,2).join(", ")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-gaming-accent text-sm font-medium",children:s.price==="0"?"Free":`$${s.price}`}),e.jsx("div",{className:"text-gray-500 text-xs",children:s.platforms.slice(0,2).join(", ")})]})]},s.id))}),p&&r.trim().length>=2&&h.length===0&&!d&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg p-4",children:e.jsxs("p",{className:"text-gray-400 text-center",children:['No GOG games found for "',r,'"']})})]})},ae=({children:t,fallback:a,onError:r})=>{const{showError:m}=$(),h=(l,d)=>{m(`Component error: ${l.message}`),r&&r(l,d)};return e.jsx(z,{fallback:a,onError:h,children:t})},re=({options:t,selected:a,onChange:r,placeholder:m="Select options...",className:h=""})=>{const[l,d]=g.useState(!1),[x,p]=g.useState(""),y=g.useRef(null),N=t.filter(o=>o.toLowerCase().includes(x.toLowerCase())&&!a.includes(o));g.useEffect(()=>{const o=f=>{y.current&&!y.current.contains(f.target)&&(d(!1),p(""))};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]);const S=o=>{r([...a,o]),p("")},s=o=>{r(a.filter(f=>f!==o))},n=o=>{o.key==="Enter"&&l&&N.length>0?S(N[0]):o.key==="Escape"&&(d(!1),p(""))};return e.jsxs("div",{ref:y,className:`relative ${h}`,children:[e.jsx("div",{className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white cursor-pointer min-h-[42px] focus:outline-none focus:border-gaming-primary",onClick:()=>d(!l),children:a.length===0?e.jsx("span",{className:"text-gray-400",children:m}):e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(o=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gaming-primary/20 text-gaming-primary rounded text-sm",children:[o,e.jsx("button",{onClick:f=>{f.stopPropagation(),s(o)},className:"hover:text-gaming-secondary transition-colors",children:"âœ•"})]},o))})}),l&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[e.jsx("div",{className:"p-2 border-b border-gray-700",children:e.jsx("input",{type:"text",placeholder:"Search...",value:x,onChange:o=>p(o.target.value),onKeyDown:n,className:"w-full px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white placeholder-gray-400 focus:outline-none focus:border-gaming-primary",autoFocus:!0})}),N.length===0?e.jsx("div",{className:"p-3 text-gray-400 text-sm text-center",children:x?"No options found":"All options selected"}):N.map(o=>e.jsx("div",{onClick:()=>S(o),className:"px-3 py-2 hover:bg-gray-700 cursor-pointer text-white transition-colors",children:o},o))]})]})},se=({selected:t,onChange:a,placeholder:r="Select tags...",className:m=""})=>{const[h,l]=g.useState(!1),[d,x]=g.useState(""),[p,y]=g.useState(""),N=g.useRef(null),S=V.filter(i=>i.name.toLowerCase().includes(d.toLowerCase())&&!t.includes(i.name));g.useEffect(()=>{const i=u=>{N.current&&!N.current.contains(u.target)&&(l(!1),x(""),y(""))};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[]);const s=i=>{a([...t,i]),x("")},n=i=>{a(t.filter(u=>u!==i))},o=()=>{const i=p.trim();i&&!t.includes(i)&&(a([...t,i]),y(""),x(""))},f=i=>{i.key==="Enter"?(i.preventDefault(),S.length===0&&p.trim()?o():S.length>0&&s(S[0].name)):i.key==="Escape"&&(l(!1),x(""),y(""))};return e.jsxs("div",{ref:N,className:`relative ${m}`,children:[e.jsx("div",{className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white cursor-pointer min-h-[42px] focus:outline-none focus:border-gaming-primary",onClick:()=>l(!h),children:t.length===0?e.jsx("span",{className:"text-gray-400",children:r}):e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(i=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gaming-primary/20 text-gaming-primary rounded text-sm",children:[i,e.jsx("button",{onClick:u=>{u.stopPropagation(),n(i)},className:"hover:text-gaming-secondary transition-colors",children:"âœ•"})]},i))})}),h&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[e.jsx("div",{className:"p-2 border-b border-gray-700",children:e.jsx("input",{type:"text",placeholder:"Search or add custom tag...",value:p||d,onChange:i=>{const u=i.target.value;u.startsWith("+")||u.startsWith("#")?(y(u),x("")):(x(u),y(""))},onKeyDown:f,className:"w-full px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white placeholder-gray-400 focus:outline-none focus:border-gaming-primary",autoFocus:!0})}),p&&e.jsxs("div",{className:"px-3 py-2 text-xs text-gray-400 border-b border-gray-700",children:['Press Enter to add custom tag: "',p,'"']}),S.length===0&&!p?e.jsx("div",{className:"p-3 text-gray-400 text-sm text-center",children:d?"No tags found":"All tags selected"}):S.map(i=>e.jsxs("div",{onClick:()=>s(i.name),className:"px-3 py-2 hover:bg-gray-700 cursor-pointer text-white transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:i.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${i.color} bg-gray-900`,children:i.category.charAt(0).toUpperCase()})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:i.description})]},i.id))]})]})},oe=({isOpen:t,onClose:a,onAddGame:r})=>{const{showSuccess:m,showError:h}=$(),[l,d]=g.useState({title:"",genres:[],moods:[],tags:[],platforms:[],playStatus:"backlog",status:"backlog",coverImage:"",launcherId:""}),[x,p]=g.useState("manual"),y=s=>{const n=R.convertGOGGameToGame(s);d({title:n.title||"",genres:n.genres?.map(o=>o.name)||[],moods:[],platforms:n.platforms||[],playStatus:"backlog",status:"backlog",tags:n.tags||[],coverImage:n.coverImage||"",launcherId:n.launcherId||""})},N=async s=>{s.preventDefault();try{const n={title:l.title,genres:l.genres.map(o=>({id:o.toLowerCase().replace(/\s+/g,"-"),name:o,description:`${o} games`,icon:"ðŸŽ®",color:"#"+Math.floor(Math.random()*16777215).toString(16),tags:[o.toLowerCase()]})),platforms:l.platforms.map(o=>({id:o,name:o.charAt(0).toUpperCase()+o.slice(1),code:o,isConnected:!1})),playStatus:l.playStatus,tags:l.tags,coverImage:l.coverImage||"",hoursPlayed:0,userRating:void 0,achievements:{unlocked:0,total:0},launcherId:l.launcherId||void 0,addedAt:new Date,releaseYear:new Date().getFullYear(),emotionalTags:l.moods.map(o=>o),moods:l.moods,isFavorite:!1,notes:"",globalRating:void 0,lastPlayed:void 0,totalPlaytime:0,averageRating:void 0,completionPercentage:void 0};console.log("ðŸŽ® Adding game:",n),r(n),m(`"${n.title}" added to your library`),a()}catch(n){console.error("âŒ Failed to add game:",n),h("Failed to add game. Please try again.")}},S=s=>{d(n=>({...n,platforms:n.platforms.includes(s)?n.platforms.filter(o=>o!==s):[...n.platforms,s]}))};return t?e.jsx(ae,{children:e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"glass-morphism rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto cinematic-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Add New Game"}),e.jsx("button",{onClick:a,className:"w-10 h-10 bg-black/50 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-black/70 transition-colors",children:"âœ•"})]}),e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Add From Platform"}),e.jsxs("select",{value:x,onChange:s=>p(s.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none","aria-label":"Select platform to add game from",children:[e.jsx("option",{value:"manual",children:"ðŸ“ Manual Entry"}),e.jsx("option",{value:"steam",children:"ðŸŽ® Steam Search"}),e.jsx("option",{value:"gog",children:"ðŸŽ¯ GOG Search"})]})]}),x==="gog"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search GOG Games"}),e.jsx(te,{onGameSelect:y,placeholder:"Search GOG catalog..."})]}),x==="steam"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search Steam Games"}),e.jsx("div",{className:"text-gray-400 text-sm p-3 bg-gray-800 rounded-lg",children:"Steam search coming soon! Use Steam Import for full library access."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:l.title,onChange:s=>d(n=>({...n,title:s.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none",placeholder:"Enter game title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Genres"}),e.jsx(re,{options:B.map(s=>s.name),selected:l.genres,onChange:s=>d(n=>({...n,genres:s})),placeholder:"Select genres..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Moods"}),e.jsx("div",{className:"space-y-2",children:D.map(s=>e.jsxs("label",{className:"flex items-center space-x-2 text-gray-300 cursor-pointer hover:text-white transition-colors",children:[e.jsx("input",{type:"checkbox",checked:l.moods.includes(s.id),onChange:n=>{n.target.checked?d(o=>({...o,moods:[...o.moods,s.id]})):d(o=>({...o,moods:o.moods.filter(f=>f!==s.id)}))},className:"rounded border-gray-600 bg-gray-700 text-blue-500 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{children:s.name}),e.jsx("span",{className:"text-gray-500 text-sm",children:s.emoji})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Platforms"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["steam","epic","gog"].map(s=>e.jsxs("label",{className:"flex items-center space-x-2 text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:l.platforms.includes(s),onChange:()=>S(s),className:"rounded border-gray-600 bg-gray-700 text-gaming-primary focus:ring-gaming-primary"}),e.jsx("span",{className:"text-sm capitalize",children:s})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{value:l.status,onChange:s=>d(n=>({...n,status:s.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none","aria-label":"Select game status",children:[e.jsx("option",{value:"backlog",children:"ðŸ“š Backlog"}),e.jsx("option",{value:"playing",children:"ðŸŽ® Playing"}),e.jsx("option",{value:"completed",children:"âœ… Completed"}),e.jsx("option",{value:"abandoned",children:"ðŸš« Abandoned"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Launcher ID"}),e.jsx("input",{type:"text",value:l.launcherId,onChange:s=>d(n=>({...n,launcherId:s.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none",placeholder:"Steam App ID, Epic Catalog ID, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tags"}),e.jsx(se,{selected:l.tags,onChange:s=>d(n=>({...n,tags:s})),placeholder:"Select or add tags..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Cover Image URL"}),e.jsx("input",{type:"url",value:l.coverImage,onChange:s=>d(n=>({...n,coverImage:s.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none",placeholder:"https://example.com/cover.jpg"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:a,className:"px-6 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-gradient-to-r from-gaming-primary to-gaming-secondary text-white rounded-lg hover:opacity-90 transition-opacity",children:"Add Game"})]})]})]})})})}):null},ie=({size:t="md",className:a=""})=>{const r={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8",xl:"w-12 h-12"};return e.jsx("div",{className:`inline-block animate-spin ${r[t]} ${a}`,children:e.jsxs("svg",{className:"w-full h-full text-gaming-primary",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},ne=({children:t,message:a="Loading...",size:r="lg",fullScreen:m=!1,className:h=""})=>{const l=e.jsxs("div",{className:`flex flex-col items-center justify-center space-y-4 ${h}`,children:[e.jsx(ie,{size:r}),a&&e.jsx("p",{className:"text-gray-300 text-center animate-pulse",children:a}),t]});return m?e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-gaming-dark via-gray-900 to-gaming-darker z-50 flex items-center justify-center",children:e.jsx("div",{className:"glass-morphism rounded-xl p-8 border border-white/10",children:l})}):l},le=({isOpen:t,onClose:a,onImportGames:r})=>{const[m,h]=g.useState(""),[l,d]=g.useState(""),[x,p]=g.useState(""),[y,N]=g.useState(!1),{actions:S,isLoading:s,games:n}=A(),{user:o}=F();g.useEffect(()=>{if(o?.steamId||o?.steamProfile){const i=o?.steamId||(o?.steamProfile||"").split("/").pop();i&&(h(i),console.log("ðŸŽ¯ Auto-filled Steam ID from logged-in user:",i))}},[o]);const f=async()=>{if(console.log("ðŸŽ® SteamImportModal: handleImport called!"),console.log("ðŸŽ® SteamImportModal: Steam ID:",m),console.log("ðŸŽ® SteamImportModal: Force re-import:",y),!m){console.log("ðŸŽ® SteamImportModal: No Steam ID provided"),d("Steam ID is required"),p("Please try logging in with Steam again");return}console.log("ðŸŽ® SteamImportModal: Starting import process..."),d("Fetching your Steam library..."),p("");try{const i="FBB124C9352519E8F9FE820ADF0DA87C";console.log("ðŸŽ® SteamImportModal: Calling importSteamLibrary with Steam ID:",m);const u=await S.importSteamLibrary(m,i,y);console.log("ðŸŽ® SteamImportModal: Import result:",u),u.success&&u.gameCount>0?(console.log("ðŸŽ® SteamImportModal: Import successful! Games:",u.gameCount),d(`Successfully imported ${u.gameCount} games!`),console.log("ðŸŽ® SteamImportModal: Calling onImportGames callback with",u.games.length,"games"),r(u.games.map(I=>({...I,id:I.id}))),setTimeout(()=>{console.log("ðŸŽ® SteamImportModal: Closing modal..."),a(),d(""),p(""),h("")},2e3)):(console.log("ðŸŽ® SteamImportModal: No games found"),d("No games found in your Steam library"),p("Make sure your Steam profile is public and you own games"))}catch(i){console.error("ðŸŽ® SteamImportModal: Import error:",i);let u="Unknown error occurred",I="Please try again later";i instanceof Error?(u=i.message,console.log("ðŸŽ® SteamImportModal: Error message:",u),console.log("ðŸŽ® SteamImportModal: Error stack:",i.stack)):typeof i=="string"?u=i:i&&typeof i=="object"&&(u="Steam API request failed",I=JSON.stringify(i,null,2),console.log("ðŸŽ® SteamImportModal: Error object:",i)),u.includes("Invalid Steam Web API key")?(d("Invalid API Key"),p("Please check your Steam Web API key and try again")):u.includes("Steam profile is private")?(d("Private Profile"),p("Please make your Steam profile public and set your game details to public")):u.includes("Invalid Steam ID")?(d("Invalid Steam ID"),p("Please check your Steam ID and ensure your profile is public")):u.includes("Failed to connect")||u.includes("Failed to fetch")?(d("Connection Error"),p("Unable to connect to Steam API. Please check your internet connection and try again.")):u.includes("Steam API request failed")?(d("API Error"),p("Steam API is temporarily unavailable. Please try again in a few minutes.")):(d("Import Failed"),p(`${u}. ${I}`))}finally{console.log("ðŸŽ® SteamImportModal: Import process completed")}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"glass-morphism rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto cinematic-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Import Steam Library"}),e.jsx("button",{onClick:a,className:"w-10 h-10 bg-black/50 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-black/70 transition-colors",children:"âœ•"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Steam ID"}),e.jsx("input",{type:"text",value:m,onChange:i=>h(i.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none",placeholder:"Your Steam ID (auto-filled from login)",disabled:s||!!o?.steamId||!!o?.steamProfile}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:o?.steamId||o?.steamProfile?"Steam ID auto-filled from your login":"Find your Steam ID in your profile URL"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3 mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"Import Your Steam Library"}),e.jsx("p",{className:"text-xs text-gray-400 mb-3",children:'Click "Import Library" to fetch all games from your Steam account. This will import game titles, playtime, achievements, and cover images.'}),n.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"forceReimport",checked:y,onChange:i=>N(i.target.checked),className:"w-4 h-4 text-gaming-accent bg-gray-700 border-gray-600 rounded focus:ring-gaming-accent focus:ring-2"}),e.jsx("label",{htmlFor:"forceReimport",className:"text-xs text-gray-300",children:"Force re-import (update existing games)"})]})]}),(l||x)&&e.jsxs("div",{className:`p-3 rounded-lg text-sm ${l.includes("Successfully")?"bg-green-600/20 text-green-400 border border-green-600/50":"bg-red-600/20 text-red-400 border border-red-600/50"}`,children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[s&&e.jsx(ne,{}),l]}),x&&e.jsx("div",{className:"text-xs mt-1 opacity-75",children:x})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,disabled:s,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:f,disabled:s||!m,className:"flex-1 px-4 py-2 bg-gradient-to-r from-gaming-primary to-gaming-secondary text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Importing...":"Import Library"})]})]})]})})}):null},ce=()=>e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden animate-pulse",children:[e.jsx("div",{className:"aspect-[3/4] bg-gray-700"}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-700 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-700 rounded w-1/2"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-6 w-6 bg-gray-700 rounded-full"}),e.jsx("div",{className:"h-3 bg-gray-700 rounded w-16"})]})]})]}),de=({count:t=12})=>e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-6",children:Array.from({length:t}).map((a,r)=>e.jsx(ce,{},r))}),L={adrenaline:["intense","competitive","high-energy","action-packed"],"brain-power":["strategic","puzzle","thinking","tactical"],zen:["relaxing","cozy","atmospheric","wholesome"],story:["narrative","story-rich","immersive","adventure"],social:["multiplayer","cooperative","party","team-based"],creative:["building","crafting","sandbox","artistic"],nostalgic:["retro","classic","remastered","throwback"],scary:["horror","scary","terrifying"]},he=()=>{const{games:t,actions:a,intelligence:r,setIntelligenceState:m}=A(),[h,l]=g.useState(!0);g.useEffect(()=>{console.log("ðŸŽ® Loading library..."),a.loadGames()},[a]),g.useEffect(()=>{t!==null&&l(!1)},[t]),g.useEffect(()=>{console.log("ðŸ§¹ Library component mounted - clearing mood cache..."),O(),t&&t.length>0&&(console.log("ðŸ”„ Forcing re-evaluation of all game moods..."),t.forEach(c=>{c.moods&&Array.isArray(c.moods)&&delete c.moods}))},[t]);const[d,x]=g.useState(""),[p,y]=g.useState([]),[N,S]=g.useState(!1),[s,n]=g.useState(!1),[o,f]=g.useState(!1),i=g.useMemo(()=>{console.log("ðŸ” DEBUG: Raw games count:",t?.length||0);const c=t?.length?H(t):[];if(console.log("ðŸ” DEBUG: Normalized games count:",c.length),c.length>0){console.log("ðŸ” DEBUG: Testing mood assignment on first game...");const k=c[0];console.log("ðŸ” DEBUG: First game before mood assignment:",{title:k.title,currentMoods:k.moods,genres:k.genres})}return c},[t]),u=g.useMemo(()=>{let c=[...i];console.log("ðŸ“Š MOOD DISTRIBUTION ANALYSIS:");const k={},G={};if(c.forEach(v=>{(Array.isArray(v.moods)?v.moods:[]).forEach(b=>{k[b]=(k[b]||0)+1}),(Array.isArray(v.genres)?v.genres.map(b=>b.name||b):[]).forEach(b=>{G[b]=(G[b]||0)+1})}),console.log("ðŸŽ­ Mood Distribution:",k),console.log("ðŸŽ® Genre Distribution:",G),console.log("ðŸ“ˆ Total Games:",c.length),d.trim()!==""){const v=d.toLowerCase();c=c.filter(j=>j.title?.toLowerCase().includes(v))}return r.selectedMasterMood&&(console.log(`ðŸ” DEBUG: Filtering for ${r.selectedMasterMood}`),console.log("ðŸ” DEBUG: Allowed sub-moods:",L[r.selectedMasterMood]),c=c.filter(v=>{const j=Array.isArray(v.moods)?v.moods:[],w=String(r.selectedMasterMood).toLowerCase(),b=(L[r.selectedMasterMood]||[]).map(M=>String(M).toLowerCase()),C=[w,...b],P=j.some(M=>C.includes(String(M).toLowerCase()));return(r.selectedMasterMood==="social"||r.selectedMasterMood==="creative"||r.selectedMasterMood==="nostalgic")&&console.log(`ðŸ” DEBUG: Game "${v.title}" - Moods: [${j.join(", ")}] - Match: ${P}`),P}),console.log(`ðŸ” DEBUG: Filtered from ${i.length} to ${c.length} games for ${r.selectedMasterMood}`)),c.sort((v,j)=>{switch(r.selectedSorting){case"rating":return(j.globalRating||0)-(v.globalRating||0);case"playtime":return(j.hoursPlayed||0)-(v.hoursPlayed||0);default:return(v.title||"").localeCompare(j.title||"")}}),c},[i,d,r.selectedMasterMood,r.selectedSorting]),I=c=>{y(k=>k.includes(c)?k.filter(G=>G!==c):[...k,c])};return e.jsx("div",{className:"min-h-screen bg-gaming-dark text-white",children:e.jsxs("div",{className:"container mx-auto px-6 py-12",children:[e.jsxs("header",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-12",children:[e.jsxs("div",{children:[e.jsx(E.h1,{className:"text-5xl font-gaming font-bold bg-gradient-to-r from-gaming-primary to-gaming-accent bg-clip-text text-transparent mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:"Your Library"}),e.jsx("p",{className:"text-gray-400 text-lg max-w-xl",children:"Managed collection with normalized intelligence."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>f(!0),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl hover:bg-white/10 transition-all flex items-center gap-3",children:[e.jsx("span",{children:"ðŸ”—"})," Import Steam"]}),e.jsx("button",{onClick:()=>n(!0),className:"px-6 py-3 bg-gaming-primary text-white rounded-xl shadow-lg font-bold",children:"+ Add Game"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10",children:[e.jsx("aside",{className:"lg:col-span-3 space-y-8",children:e.jsxs("div",{className:"gaming-card rounded-2xl p-6 border border-white/5 sticky top-24 bg-gray-900/50 backdrop-blur-md",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"text-gaming-primary text-lg",children:"ðŸ§ "})," Intelligence"]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:"Mood"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:W.map(c=>e.jsxs("button",{onClick:()=>m({...r,selectedMasterMood:r.selectedMasterMood===c.id?"":c.id}),className:`px-3 py-2 rounded-lg text-[10px] font-black uppercase transition-all border ${r.selectedMasterMood===c.id?"bg-gaming-primary/20 border-gaming-primary text-gaming-primary":"bg-white/5 border-transparent text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"text-4xl mb-2",children:c.emoji}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-tighter",children:c.name})]},c.id))})]}),e.jsx("button",{onClick:()=>m({selectedMasterMood:"",selectedSorting:"title"}),className:"w-full py-3 text-xs font-bold text-gray-500 hover:text-white transition-colors",children:"Reset Filters"}),e.jsx("button",{onClick:()=>{O(),window.location.reload()},className:"w-full mt-2 py-3 text-xs font-bold text-gaming-primary hover:text-white transition-colors border border-gaming-primary/20 rounded",children:"ðŸ§¹ Clear Mood Cache"})]})}),e.jsxs("main",{className:"lg:col-span-9 space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-white/5 to-white/10 backdrop-blur-md rounded-2xl border border-white/10 p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-center justify-between",children:[e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500",children:"ðŸ”"}),e.jsx("input",{type:"text",placeholder:"Search collection...",value:d,onChange:c=>x(c.target.value),className:"w-full pl-12 pr-4 py-3 bg-gray-900 rounded-xl border border-white/10 focus:ring-2 focus:ring-gaming-primary/50 outline-none"})]}),e.jsxs("select",{value:r.selectedSorting,onChange:c=>m({...r,selectedSorting:c.target.value}),className:"bg-gray-900 text-sm font-bold text-gray-300 border border-white/10 rounded-lg px-4 py-3 outline-none",title:"Sort games by",children:[e.jsx("option",{value:"title",children:"Alphabetical"}),e.jsx("option",{value:"rating",children:"Top Rated"}),e.jsx("option",{value:"playtime",children:"Most Played"})]})]})}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-2xl border border-white/10 p-6 min-h-[500px]",children:[h?e.jsx(de,{count:12}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:u.map((c,k)=>e.jsx(Z,{game:c,onSelect:()=>I(c.id),onLaunch:G=>{G.appId?a.launchGame(G.appId.toString()):console.warn("No appId found for game:",G.title)}},`${c.id||c.title}-${k}`))}),!h&&u.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx("span",{className:"text-4xl mb-4",children:"ðŸŽ®"}),e.jsx("p",{children:"No games match these criteria."})]})]})]})]}),e.jsxs(U,{children:[s&&e.jsx(oe,{isOpen:s,onClose:()=>n(!1),onAddGame:c=>{a.setGames([...t,{...c,id:crypto.randomUUID()}]),n(!1)}}),o&&e.jsx(le,{isOpen:o,onClose:()=>f(!1),onImportGames:c=>{a.setGames([...t,...c]),f(!1)}})]})]})})};export{he as Library,he as default};
