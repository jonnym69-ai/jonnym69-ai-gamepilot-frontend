var F=Object.defineProperty;var U=(t,a,r)=>a in t?F(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r;var E=(t,a,r)=>(U(t,typeof a!="symbol"?a+"":a,r),r);import{r as p,j as e,u as B,m as A,e as D,E as H,f as W,A as _}from"./index-db369dc9.js";import{u as L,b as q,c as O,n as K}from"./useLibraryStore-cd6ac89d.js";import{M as V}from"./masterMoods-2bce0da6.js";import{u as Y,p as Q}from"./useMemoryOptimization-43c8807d.js";const T=[{id:"Intense",name:"Intense",description:"High-pressure, competitive, fast-paced gameplay",emoji:"ðŸ”¥",icon:"âš¡",color:"from-red-500 to-orange-600",intensity:9,associatedGenres:["action","fps","multiplayer"]},{id:"Strategic",name:"Strategic",description:"Requires planning, tactics, careful decision-making",emoji:"ðŸ§ ",icon:"â™Ÿï¸",color:"from-blue-500 to-indigo-600",intensity:7,associatedGenres:["strategy","puzzle","rpg"]},{id:"Relaxing",name:"Relaxing",description:"Low-stress, peaceful, zen-like gameplay",emoji:"ðŸ˜Œ",icon:"ðŸŒŠ",color:"from-blue-400 to-cyan-500",intensity:2,associatedGenres:["casual","simulation","puzzle"]},{id:"Creative",name:"Creative",description:"Building, crafting, expression, customization",emoji:"ðŸŽ¨",icon:"ðŸŽ­",color:"from-green-500 to-emerald-600",intensity:6,associatedGenres:["simulation","casual","puzzle"]},{id:"High-Energy",name:"High-Energy",description:"Action-packed, exciting, adrenaline-fueled",emoji:"âš¡",icon:"ðŸš€",color:"from-yellow-500 to-amber-600",intensity:8,associatedGenres:["action","racing","sports"]},{id:"Atmospheric",name:"Atmospheric",description:"Immersive world-building, exploration, mood-setting",emoji:"ðŸŒ«",icon:"ðŸŒ ",color:"from-gray-500 to-slate-600",intensity:4,associatedGenres:["adventure","horror","rpg"]},{id:"Challenging",name:"Challenging",description:"Difficult, requires skill, punishing gameplay",emoji:"ðŸ†",icon:"âš”ï¸",color:"from-purple-500 to-pink-600",intensity:8,associatedGenres:["strategy","action","rpg"]},{id:"Story-Rich",name:"Story-Rich",description:"Narrative-driven, plot-heavy, story-focused",emoji:"ðŸ“š",icon:"ðŸ“–",color:"from-indigo-500 to-purple-600",intensity:6,associatedGenres:["rpg","adventure","narrative"]},{id:"Competitive",name:"Competitive",description:"Competition-focused, achievement-driven, versus play",emoji:"ðŸ†",icon:"ðŸ”¥",color:"from-red-500 to-orange-600",intensity:9,associatedGenres:["action","sports","multiplayer"]},{id:"Social",name:"Social",description:"Multiplayer, community, cooperative gameplay",emoji:"ðŸ‘¥",icon:"ðŸ¤",color:"from-teal-500 to-cyan-600",intensity:5,associatedGenres:["multiplayer","casual","party"]},{id:"Experimental",name:"Experimental",description:"Innovative, boundary-pushing, unique mechanics",emoji:"ðŸ§ª",icon:"âš—ï¸",color:"from-pink-500 to-rose-600",intensity:7,associatedGenres:["indie","puzzle","simulation"]},{id:"Mindful",name:"Mindful",description:"Thoughtful, deliberate, contemplative gameplay",emoji:"ðŸ§˜",icon:"ðŸ§ ",color:"from-purple-500 to-indigo-600",intensity:3,associatedGenres:["puzzle","strategy","meditation"]},{id:"Nostalgic",name:"Nostalgic",description:"Retro-inspired, classic, timeless appeal",emoji:"ðŸ•°",icon:"ðŸŽ®",color:"from-amber-500 to-yellow-600",intensity:4,associatedGenres:["retro","classic","arcade"]},{id:"Gritty",name:"Gritty",description:"Tough, demanding, perseverance-testing",emoji:"ðŸ’ª",icon:"ðŸ›¡ï¸",color:"from-gray-500 to-slate-600",intensity:8,associatedGenres:["strategy","survival","hardcore"]},{id:"Surreal",name:"Surreal",description:"Dream-like, abstract, mind-bending",emoji:"ðŸŒŒ",icon:"ðŸŽ­",color:"from-purple-500 to-pink-600",intensity:7,associatedGenres:["puzzle","art","experimental"]},{id:"Action-Packed",name:"Action-Packed",description:"Non-stop action, constant excitement, thrilling",emoji:"âš¡",icon:"ðŸš€",color:"from-red-500 to-orange-600",intensity:10,associatedGenres:["action","shooter","adventure"]},{id:"Dark",name:"Dark",description:"Mature themes, horror elements, intense atmosphere",emoji:"ðŸŒ‘",icon:"ðŸ’€",color:"from-black to-gray-600",intensity:8,associatedGenres:["horror","action","adventure"]},{id:"Humorous",name:"Humorous",description:"Comedic, lighthearted, entertaining gameplay",emoji:"ðŸ˜‚",icon:"ðŸ¤£",color:"from-yellow-500 to-orange-600",intensity:4,associatedGenres:["comedy","casual","party"]},{id:"Educational",name:"Educational",description:"Learning-focused, informative, skill-building",emoji:"ðŸ“š",icon:"ðŸŽ“",color:"from-blue-500 to-indigo-600",intensity:5,associatedGenres:["educational","puzzle","strategy"]},{id:"Retro",name:"Retro",description:"Classic gameplay, nostalgic feel, old-school charm",emoji:"ðŸ•¹ï¸",icon:"ðŸ‘¾",color:"from-green-500 to-emerald-600",intensity:6,associatedGenres:["retro","classic","arcade"]},{id:"Open-World",name:"Open-World",description:"Exploration-focused, sandbox gameplay, freedom",emoji:"ðŸŒ",icon:"ðŸ—ºï¸",color:"from-blue-500 to-indigo-600",intensity:7,associatedGenres:["open-world","adventure","rpg"]},{id:"Cooperative",name:"Cooperative",description:"Multiplayer, teamwork, cooperative gameplay",emoji:"ðŸ‘«",icon:"ðŸ¤",color:"from-teal-500 to-cyan-600",intensity:5,associatedGenres:["multiplayer","cooperative","party"]},{id:"Fast-Paced",name:"Fast-Paced",description:"Quick reflexes, rapid action, thrilling gameplay",emoji:"âš¡",icon:"ðŸŽï¸",color:"from-red-500 to-orange-600",intensity:9,associatedGenres:["action","racing","sports"]},{id:"Immersive",name:"Immersive",description:"Engaging storyline, interactive gameplay, immersive atmosphere",emoji:"ðŸ“º",icon:"ðŸŽ¬",color:"from-purple-500 to-pink-600",intensity:8,associatedGenres:["adventure","rpg","narrative"]},{id:"Casual",name:"Casual",description:"Easy to play, relaxing, laid-back gameplay",emoji:"ðŸ˜Š",icon:"ðŸ‘Œ",color:"from-green-500 to-emerald-600",intensity:3,associatedGenres:["casual","puzzle","simulation"]},{id:"Scary",name:"Scary",description:"Horror-filled, terrifying, spine-chilling gameplay",emoji:"ðŸ˜±",icon:"ðŸ‘»",color:"from-gray-900 to-black",intensity:10,associatedGenres:["horror","survival","thriller"]}],J=[{id:"cozy",name:"Cozy",category:"gameplay",description:"Comforting and relaxing gameplay",color:"text-amber-400"},{id:"sweaty",name:"Sweaty",category:"gameplay",description:"Intense and challenging gameplay",color:"text-red-400"},{id:"story-heavy",name:"Story-Heavy",category:"gameplay",description:"Rich narrative focus",color:"text-purple-400"},{id:"sandbox",name:"Sandbox",category:"gameplay",description:"Open-ended creative freedom",color:"text-green-400"},{id:"roguelike",name:"Roguelike",category:"gameplay",description:"Procedural generation with permadeath",color:"text-orange-400"},{id:"turn-based",name:"Turn-Based",category:"gameplay",description:"Strategic, non-real-time gameplay",color:"text-blue-400"},{id:"real-time",name:"Real-Time",category:"gameplay",description:"Continuous action gameplay",color:"text-red-500"},{id:"pixel-perfect",name:"Pixel-Perfect",category:"gameplay",description:"Precise platforming or controls",color:"text-pink-400"},{id:"atmospheric",name:"Atmospheric",category:"atmosphere",description:"Immersive and mood-setting",color:"text-indigo-400"},{id:"relaxing",name:"Relaxing",category:"atmosphere",description:"Calming and stress-free",color:"text-cyan-400"},{id:"intense",name:"Intense",category:"atmosphere",description:"High-stakes and exciting",color:"text-red-600"},{id:"mysterious",name:"Mysterious",category:"atmosphere",description:"Intriguing and enigmatic",color:"text-purple-600"},{id:"wholesome",name:"Wholesome",category:"atmosphere",description:"Heartwarming and positive",color:"text-pink-300"},{id:"dark",name:"Dark",category:"atmosphere",description:"Mature and serious themes",color:"text-gray-600"},{id:"easy",name:"Easy",category:"difficulty",description:"Accessible and forgiving",color:"text-green-500"},{id:"challenging",name:"Challenging",category:"difficulty",description:"Tests player skills",color:"text-orange-500"},{id:"brutal",name:"Brutal",category:"difficulty",description:"Extremely difficult",color:"text-red-700"},{id:"single-player",name:"Single-Player",category:"social",description:"Solo gaming experience",color:"text-blue-500"},{id:"co-op",name:"Co-op",category:"social",description:"Cooperative multiplayer",color:"text-teal-500"},{id:"pvp",name:"PvP",category:"social",description:"Player versus player",color:"text-red-500"},{id:"community-driven",name:"Community-Driven",category:"social",description:"Relies on player community",color:"text-purple-500"},{id:"fantasy",name:"Fantasy",category:"theme",description:"Magic and mythical settings",color:"text-purple-400"},{id:"sci-fi",name:"Sci-Fi",category:"theme",description:"Science fiction settings",color:"text-cyan-400"},{id:"modern",name:"Modern",category:"theme",description:"Contemporary settings",color:"text-gray-400"},{id:"historical",name:"Historical",category:"theme",description:"Historical periods",color:"text-amber-600"},{id:"post-apocalyptic",name:"Post-Apocalyptic",category:"theme",description:"End-of-world scenarios",color:"text-gray-700"},{id:"backlog",name:"Backlog",category:"gameplay",description:"Games to play later",color:"text-yellow-400"}];function X(t,a="616x353"){const r={square:"800x800",portrait:"600x900",landscape:"1200x900","616x353":"616x353","800x800":"800x800","1200x900":"1200x900"},c=r[a]||r["616x353"];return[`https://cdn.cloudflare.steamstatic.com/steam/apps/${t.appId||t.id}/capsule_616x353.jpg`,`https://cdn.cloudflare.steamstatic.com/steam/apps/${t.appId||t.id}/header.jpg`,`https://cdn.cloudflare.steamstatic.com/steam/apps/${t.appId||t.id}/library_600x900.jpg`,t.coverImage,t.headerImage,t.imageUrl,t.steamHeaderImage,t.steamCapsuleImage,t.capsuleImage,t.headerImage,t.smallHeaderImage,`https://picsum.photos/seed/${t.title.replace(/\s+/g,"-")}-${t.id}/${c}.jpg`].filter(Boolean)[0]||`https://picsum.photos/seed/${t.title.replace(/\s+/g,"-")}-${t.id}/${c}.jpg`}function Z({src:t,alt:a,className:r="",onLoad:c,onError:m,sizes:d="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",webpSrc:g,avifSrc:h,priority:u=!1}){const[x,v]=p.useState(!1),[b,i]=p.useState(u),[l,s]=p.useState(!1),y=p.useRef(null),n=ee(),o=te(),{observe:f,unobserve:k}=Y(j=>{j.forEach(M=>{M.isIntersecting&&(i(!0),y.current&&k(y.current))})},{threshold:.1,rootMargin:"50px"});p.useEffect(()=>(!u&&y.current&&f(y.current),()=>{!u&&y.current&&k(y.current)}),[f,k,u]);const N=()=>{v(!0),c==null||c()},S=()=>{s(!0),m==null||m()};p.useEffect(()=>{b&&!l&&Q(h&&o?h:g&&n?g:t).then(N).catch(S)},[b,t,g,h,n,o,l]);const I=j=>!j.includes("cdn")&&!j.includes("steam")?j:[256,512,1024].map(C=>`${j}?w=${C} ${C}w`).join(", ");return e.jsxs("div",{ref:y,className:`relative aspect-square overflow-hidden ${r}`,children:[e.jsxs("div",{className:`
          absolute inset-0 bg-gradient-to-br from-gray-800 via-gray-900 to-black
          flex items-center justify-center transition-all duration-500
          ${x?"opacity-0 scale-95":"opacity-100 scale-100"}
        `,children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"text-4xl text-gray-600 animate-pulse",children:"ðŸŽ®"}),e.jsx("div",{className:"absolute inset-0 blur-lg bg-gaming-primary/10 scale-150"})]}),e.jsx("div",{className:"absolute bottom-2 left-0 right-0 flex justify-center",children:e.jsx("div",{className:"w-8 h-1 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-gaming-primary to-gaming-secondary rounded-full animate-pulse"})})})]}),b&&!l&&e.jsxs("picture",{className:"absolute inset-0 w-full h-full",children:[h&&o&&e.jsx("source",{srcSet:I(h),sizes:d,type:"image/avif"}),g&&n&&e.jsx("source",{srcSet:I(g),sizes:d,type:"image/webp"}),e.jsx("img",{src:t,srcSet:I(t),sizes:d,alt:a,className:`
              absolute inset-0 w-full h-full object-center transition-opacity duration-500 optimized-image
              ${x?"opacity-100":"opacity-0"}
            `,onLoad:()=>v(!0),onError:()=>s(!0),loading:u?"eager":"lazy",decoding:"async"})]}),l&&e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-br from-red-900/30 via-red-800/20 to-red-900/30 flex flex-col items-center justify-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"text-3xl text-red-500",children:"ðŸš«"}),e.jsx("div",{className:"absolute inset-0 blur-lg bg-red-500/10 scale-150"})]}),e.jsx("span",{className:"text-xs text-red-400 mt-2 font-medium",children:"Failed to load"})]}),x&&!l&&e.jsx("div",{className:"absolute inset-0 opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/10 to-transparent"})})]})}function ee(){const[t,a]=p.useState(!1);return p.useEffect(()=>{const r=document.createElement("canvas");r.width=1,r.height=1;const c=r.getContext("2d");c&&(c.fillStyle="rgba(0,0,0,0.5)",c.fillRect(0,0,1,1),r.toBlob(m=>{a((m==null?void 0:m.type)==="image/webp")},"image/webp"))},[]),t}function te(){const[t,a]=p.useState(!1);return p.useEffect(()=>{const r=document.createElement("canvas");r.width=1,r.height=1;const c=r.getContext("2d");c&&(c.fillStyle="rgba(0,0,0,0.5)",c.fillRect(0,0,1,1),r.toBlob(m=>{a((m==null?void 0:m.type)==="image/avif")},"image/avif"))},[]),t}function ae(t){if(!t)return"chill";if(t.mood&&typeof t.mood=="string"){const a=t.mood.toLowerCase();if(["chill","competitive","story","creative","social","focused","energetic","exploratory"].includes(a))return a}if(t.moods&&Array.isArray(t.moods)){const a=t.moods.filter(r=>typeof r=="string"&&["chill","competitive","story","creative","social","focused","energetic","exploratory"].includes(r.toLowerCase()));if(a.length>0)return a[0]}return"chill"}function re({game:t,isSelected:a,isSelectable:r,onSelect:c,currentSession:m,onLaunch:d,onDelete:g,onEdit:h,recommendationScore:u}){var M,C;const x=B(),{actions:v}=L(),[b,i]=p.useState(!1),[l,s]=p.useState(!1),[y,n]=p.useState(!1);p.useEffect(()=>{s((m==null?void 0:m.gameId)===t.id)},[m,t.id]);const o=()=>{x(`/library/game/${t.id}`)},f=async()=>{if(!(y||!d)){n(!0);try{await d(t)}finally{n(!1)}}},k=async()=>{m&&await v.endGameSession(m.gameId)},N=w=>{switch(w){case"playing":return"ðŸŽ®";case"completed":return"âœ…";case"backlog":return"ðŸ“š";case"abandoned":return"ðŸš«";default:return"ðŸ“‹"}},S=w=>{const G="px-2 py-1 rounded-full text-[10px] font-black uppercase tracking-wider text-white shadow-lg backdrop-blur-md border";switch(w){case"playing":return`${G} bg-green-500/40 border-green-400/30`;case"completed":return`${G} bg-blue-500/40 border-blue-400/30`;case"backlog":return`${G} bg-gray-500/40 border-gray-400/30 text-gray-200`;case"abandoned":return`${G} bg-red-500/40 border-red-400/30`;default:return`${G} bg-gray-500/40 border-gray-400/30`}},I=t.appId&&String(t.appId).trim()!=="",j=X(t);return e.jsxs(A.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},whileHover:{scale:1.02,y:-5},className:`group relative bg-white/5 backdrop-blur-md rounded-2xl overflow-hidden border transition-all duration-300 cursor-pointer hover:z-50 hover:shadow-2xl hover:shadow-gaming-primary/20 ${a?"border-gaming-primary ring-2 ring-gaming-primary/50":"border-white/5 hover:border-white/10"}`,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[r&&e.jsx(A.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"absolute top-4 left-4 z-20",children:e.jsx("input",{type:"checkbox",checked:a,onChange:w=>{w.stopPropagation(),c==null||c(t,w.target.checked)},className:"w-6 h-6 rounded-lg border-2 border-white/20 bg-black/40 text-gaming-primary focus:ring-gaming-primary focus:ring-offset-0 transition-all cursor-pointer","aria-label":`Select ${t.title}`})}),e.jsxs("div",{className:"relative w-full aspect-[3/4] overflow-hidden bg-gray-900 flex-shrink-0",children:[j?e.jsxs(e.Fragment,{children:[e.jsx(Z,{src:j,alt:t.title,className:"w-full h-full object-cover transition-all duration-700 group-hover:scale-110 group-hover:brightness-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gaming-dark via-transparent to-transparent opacity-60 group-hover:opacity-40 transition-opacity"})]}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-white/5 group-hover:bg-white/10 transition-colors",children:e.jsx("span",{className:"text-6xl grayscale group-hover:grayscale-0 transition-all duration-500 opacity-20 group-hover:opacity-40",children:"ðŸŽ®"})}),t.playStatus&&t.playStatus!=="backlog"&&e.jsx("div",{className:"absolute top-4 right-4 z-10",children:e.jsxs("div",{className:S(t.playStatus),children:[N(t.playStatus)," ",t.playStatus]})}),t.completionPercentage!==void 0&&t.completionPercentage>0&&e.jsx("div",{className:"absolute bottom-4 right-4 z-10 scale-75 md:scale-100",children:e.jsxs("div",{className:"relative w-12 h-12 bg-black/40 backdrop-blur-md rounded-full p-1 border border-white/10",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"20",cy:"20",r:"18",stroke:"currentColor",strokeWidth:"3",fill:"none",className:"text-white/10"}),e.jsx("circle",{cx:"20",cy:"20",r:"18",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:113,strokeDashoffset:113-113*t.completionPercentage/100,className:"text-gaming-primary transition-all duration-1000"})]}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-[10px] font-black text-white",children:[Math.round(t.completionPercentage),"%"]})]})})]}),e.jsxs("div",{className:"p-5 flex flex-col h-full bg-gradient-to-b from-transparent to-black/20",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-white font-gaming font-bold text-lg line-clamp-1 group-hover:text-gaming-primary transition-colors leading-tight mb-1",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[((M=t.platforms)==null?void 0:M[0])&&e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-gray-500",children:typeof t.platforms[0]=="string"?t.platforms[0]:t.platforms[0].name}),t.hoursPlayed!==void 0&&t.hoursPlayed>0&&e.jsxs("span",{className:"text-[10px] font-black text-gaming-accent",children:["â€¢ ",Math.floor(t.hoursPlayed),"H"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-auto",children:[u&&e.jsxs("div",{className:"w-full mt-2 p-2 bg-white/5 rounded-lg border border-white/5",children:[e.jsx("div",{className:"text-xs font-bold text-gaming-primary mb-1",children:u.reasoning.primary}),e.jsx("div",{className:"space-y-1",children:u.reasoning.secondary.map((w,G)=>e.jsxs("div",{className:"text-[10px] text-gray-400",children:["â€¢ ",w]},G))}),e.jsxs("div",{className:`text-[9px] font-bold mt-2 ${u.reasoning.confidence==="high"?"text-green-400":u.reasoning.confidence==="medium"?"text-yellow-400":"text-gray-500"}`,children:[u.reasoning.confidence==="high"&&"High confidence match",u.reasoning.confidence==="medium"&&"Good potential match",u.reasoning.confidence==="low"&&"Experimental suggestion"]})]}),(t.moods&&t.moods.length>0?t.moods:[ae(t)]).slice(0,1).map(w=>{const G=T.find(z=>z.id===w);return G?e.jsxs("span",{className:"px-2.5 py-1 rounded-md bg-white/5 border border-white/5 text-[10px] font-bold text-gray-300 flex items-center gap-1.5 transition-colors group-hover:border-white/10",children:[e.jsx("span",{"aria-hidden":"true",children:G.emoji}),e.jsx("span",{className:"uppercase tracking-tighter",children:G.name})]},w):null}),((C=t.genres)==null?void 0:C[0])&&e.jsx("span",{className:"px-2.5 py-1 rounded-md bg-gaming-primary/10 border border-gaming-primary/20 text-[10px] font-bold text-gaming-primary uppercase tracking-tighter",children:typeof t.genres[0]=="string"?t.genres[0]:t.genres[0].name})]}),e.jsxs(A.div,{className:"absolute inset-x-0 bottom-0 p-4 bg-gradient-to-t from-gaming-dark to-transparent opacity-0 group-hover:opacity-100 transition-opacity translate-y-4 group-hover:translate-y-0 duration-300 flex gap-2",children:[e.jsx("button",{onClick:w=>{w.stopPropagation(),o()},className:"flex-1 py-2.5 bg-white/10 hover:bg-white/20 text-white rounded-lg text-xs font-bold transition-all border border-white/10 backdrop-blur-md",children:"Details"}),I&&e.jsx("button",{onClick:w=>{w.stopPropagation(),l?k():f()},disabled:y,className:`flex-1 py-2.5 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2 border shadow-lg ${l?"bg-red-500/80 border-red-400/50 text-white":"bg-gaming-primary border-gaming-primary/50 text-white"}`,children:l?"â¹ Stop":y?"â³...":"â–¶ Play"})]})]})]})}class P{static async searchGames(a,r=10){try{const c=`${this.SEARCH_URL}?query=${encodeURIComponent(a)}&limit=${r}&productType=game&sortBy=popularity&order=desc`,m=await fetch(c,{headers:{Accept:"application/json","User-Agent":"GamePilot/1.0"}});if(!m.ok)throw new Error(`GOG API Error: ${m.status}`);const d=await m.json();return d.products?d.products.map(this.transformGOGGame):[]}catch(c){return console.error("GOG Search Error:",c),[]}}static async getGameDetails(a){try{const r=`${this.BASE_URL}/products/${a}`,c=await fetch(r,{headers:{Accept:"application/json","User-Agent":"GamePilot/1.0"}});if(!c.ok)throw new Error(`GOG API Error: ${c.status}`);const m=await c.json();return this.transformGOGGame(m)}catch(r){return console.error("GOG Game Details Error:",r),null}}static getGOGStoreUrl(a){return`https://www.gog.com/game/${a}`}static getGOGLauncherUrl(a){return`goggalaxy://openGame/${a}`}static transformGOGGame(a){var r;return{id:a.id||a.slug,title:a.title||a.name,slug:a.slug,url:a.url||`https://www.gog.com/game/${a.slug}`,image:a.coverHorizontal||a.image||a.cover,price:((r=a.price)==null?void 0:r.amount)||"Free",developers:a.developers||[],genres:a.genres||[],platforms:a.platforms||[],releaseDate:a.releaseDate||a.release_date,description:a.description||a.summary||""}}static convertGOGGameToGame(a){return{title:a.title,launcherId:a.id,platforms:["GOG"],status:"backlog",playtime:0,coverImage:a.image,genres:a.genres,tags:[],achievements:{unlocked:0,total:0},description:a.description}}static extractGOGIdFromUrl(a){const r=a.match(/gog\.com\/game\/([^\/\?]+)/);return r?r[1]:null}static extractGOGIdFromStoreUrl(a){const r=a.match(/gog\.com\/en\/game\/([^\/\?]+)/);return r?r[1]:null}}E(P,"BASE_URL","https://api.gog.com/v2"),E(P,"SEARCH_URL","https://catalog.gog.com/v1/catalog");class ${static async searchWithCache(a){const r=a.toLowerCase().trim();if(this.searchCache.has(r))return this.searchCache.get(r);const c=await P.searchGames(a);return this.searchCache.set(r,c),setTimeout(()=>{this.searchCache.delete(r)},this.cacheTimeout),c}static clearCache(){this.searchCache.clear()}}E($,"searchCache",new Map),E($,"cacheTimeout",5*60*1e3);const se=({onGameSelect:t,placeholder:a="Search GOG games..."})=>{const[r,c]=p.useState(""),[m,d]=p.useState([]),[g,h]=p.useState(!1),[u,x]=p.useState(!1);p.useEffect(()=>{const l=setTimeout(async()=>{if(r.trim().length<2){d([]),x(!1);return}h(!0);try{const s=await $.searchWithCache(r);d(s.slice(0,8)),x(!0)}catch(s){console.error("GOG search error:",s),d([])}finally{h(!1)}},300);return()=>clearTimeout(l)},[r]);const v=i=>{t(i),c(""),d([]),x(!1)},b=i=>{i.key==="Escape"&&x(!1)};return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:r,onChange:i=>c(i.target.value),onFocus:()=>r.trim().length>=2&&x(!0),onKeyDown:b,className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none",placeholder:a}),g&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gaming-accent"})})]}),u&&m.length>0&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg max-h-96 overflow-y-auto",children:m.map(i=>e.jsxs("div",{onClick:()=>v(i),className:"flex items-center gap-3 p-3 hover:bg-gray-700 cursor-pointer border-b border-gray-700 last:border-b-0",children:[e.jsx("img",{src:i.image,alt:i.title,className:"w-12 h-12 rounded object-cover",onError:l=>{l.currentTarget.src="https://via.placeholder.com/48x48/8b5cf6/ffffff?text=GOG"}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-white font-medium truncate",children:i.title}),e.jsx("p",{className:"text-gray-400 text-sm truncate",children:i.genres.slice(0,2).join(", ")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-gaming-accent text-sm font-medium",children:i.price==="0"?"Free":`$${i.price}`}),e.jsx("div",{className:"text-gray-500 text-xs",children:i.platforms.slice(0,2).join(", ")})]})]},i.id))}),u&&r.trim().length>=2&&m.length===0&&!g&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg p-4",children:e.jsxs("p",{className:"text-gray-400 text-center",children:['No GOG games found for "',r,'"']})})]})},oe=({children:t,fallback:a,onError:r})=>{const{showError:c}=D(),m=(d,g)=>{c(`Component error: ${d.message}`),r&&r(d,g)};return e.jsx(H,{fallback:a,onError:m,children:t})},ie=({options:t,selected:a,onChange:r,placeholder:c="Select options...",className:m=""})=>{const[d,g]=p.useState(!1),[h,u]=p.useState(""),x=p.useRef(null),v=t.filter(s=>s.toLowerCase().includes(h.toLowerCase())&&!a.includes(s));p.useEffect(()=>{const s=y=>{x.current&&!x.current.contains(y.target)&&(g(!1),u(""))};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const b=s=>{r([...a,s]),u("")},i=s=>{r(a.filter(y=>y!==s))},l=s=>{s.key==="Enter"&&d&&v.length>0?b(v[0]):s.key==="Escape"&&(g(!1),u(""))};return e.jsxs("div",{ref:x,className:`relative ${m}`,children:[e.jsx("div",{className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white cursor-pointer min-h-[42px] focus:outline-none focus:border-gaming-primary",onClick:()=>g(!d),children:a.length===0?e.jsx("span",{className:"text-gray-400",children:c}):e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gaming-primary/20 text-gaming-primary rounded text-sm",children:[s,e.jsx("button",{onClick:y=>{y.stopPropagation(),i(s)},className:"hover:text-gaming-secondary transition-colors",children:"âœ•"})]},s))})}),d&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[e.jsx("div",{className:"p-2 border-b border-gray-700",children:e.jsx("input",{type:"text",placeholder:"Search...",value:h,onChange:s=>u(s.target.value),onKeyDown:l,className:"w-full px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white placeholder-gray-400 focus:outline-none focus:border-gaming-primary",autoFocus:!0})}),v.length===0?e.jsx("div",{className:"p-3 text-gray-400 text-sm text-center",children:h?"No options found":"All options selected"}):v.map(s=>e.jsx("div",{onClick:()=>b(s),className:"px-3 py-2 hover:bg-gray-700 cursor-pointer text-white transition-colors",children:s},s))]})]})},ne=({selected:t,onChange:a,placeholder:r="Select tags...",className:c=""})=>{const[m,d]=p.useState(!1),[g,h]=p.useState(""),[u,x]=p.useState(""),v=p.useRef(null),b=J.filter(n=>n.name.toLowerCase().includes(g.toLowerCase())&&!t.includes(n.name));p.useEffect(()=>{const n=o=>{v.current&&!v.current.contains(o.target)&&(d(!1),h(""),x(""))};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]);const i=n=>{a([...t,n]),h("")},l=n=>{a(t.filter(o=>o!==n))},s=()=>{const n=u.trim();n&&!t.includes(n)&&(a([...t,n]),x(""),h(""))},y=n=>{n.key==="Enter"?(n.preventDefault(),b.length===0&&u.trim()?s():b.length>0&&i(b[0].name)):n.key==="Escape"&&(d(!1),h(""),x(""))};return e.jsxs("div",{ref:v,className:`relative ${c}`,children:[e.jsx("div",{className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white cursor-pointer min-h-[42px] focus:outline-none focus:border-gaming-primary",onClick:()=>d(!m),children:t.length===0?e.jsx("span",{className:"text-gray-400",children:r}):e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(n=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gaming-primary/20 text-gaming-primary rounded text-sm",children:[n,e.jsx("button",{onClick:o=>{o.stopPropagation(),l(n)},className:"hover:text-gaming-secondary transition-colors",children:"âœ•"})]},n))})}),m&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-gray-800 border border-gray-700 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[e.jsx("div",{className:"p-2 border-b border-gray-700",children:e.jsx("input",{type:"text",placeholder:"Search or add custom tag...",value:u||g,onChange:n=>{const o=n.target.value;o.startsWith("+")||o.startsWith("#")?(x(o),h("")):(h(o),x(""))},onKeyDown:y,className:"w-full px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white placeholder-gray-400 focus:outline-none focus:border-gaming-primary",autoFocus:!0})}),u&&e.jsxs("div",{className:"px-3 py-2 text-xs text-gray-400 border-b border-gray-700",children:['Press Enter to add custom tag: "',u,'"']}),b.length===0&&!u?e.jsx("div",{className:"p-3 text-gray-400 text-sm text-center",children:g?"No tags found":"All tags selected"}):b.map(n=>e.jsxs("div",{onClick:()=>i(n.name),className:"px-3 py-2 hover:bg-gray-700 cursor-pointer text-white transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:n.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${n.color} bg-gray-900`,children:n.category.charAt(0).toUpperCase()})]}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:n.description})]},n.id))]})]})},le=({isOpen:t,onClose:a,onAddGame:r})=>{const{showSuccess:c,showError:m}=D(),[d,g]=p.useState({title:"",genres:[],moods:[],tags:[],platforms:[],playStatus:"backlog",status:"backlog",coverImage:"",launcherId:""}),[h,u]=p.useState("manual"),x=i=>{var s;const l=P.convertGOGGameToGame(i);g({title:l.title||"",genres:((s=l.genres)==null?void 0:s.map(y=>y.name))||[],moods:[],platforms:l.platforms||[],playStatus:"backlog",status:"backlog",tags:l.tags||[],coverImage:l.coverImage||"",launcherId:l.launcherId||""})},v=async i=>{i.preventDefault();try{const l={title:d.title,genres:d.genres.map(s=>({id:s.toLowerCase().replace(/\s+/g,"-"),name:s,description:`${s} games`,icon:"ðŸŽ®",color:"#"+Math.floor(Math.random()*16777215).toString(16),tags:[s.toLowerCase()]})),platforms:d.platforms.map(s=>({id:s,name:s.charAt(0).toUpperCase()+s.slice(1),code:s,isConnected:!1})),playStatus:d.playStatus,tags:d.tags,coverImage:d.coverImage||"",hoursPlayed:0,userRating:void 0,achievements:{unlocked:0,total:0},launcherId:d.launcherId||void 0,addedAt:new Date,releaseYear:new Date().getFullYear(),emotionalTags:d.moods.map(s=>s),moods:d.moods,isFavorite:!1,notes:"",globalRating:void 0,lastPlayed:void 0,totalPlaytime:0,averageRating:void 0,completionPercentage:void 0};console.log("ðŸŽ® Adding game:",l),r(l),c(`"${l.title}" added to your library`),a()}catch(l){console.error("âŒ Failed to add game:",l),m("Failed to add game. Please try again.")}},b=i=>{g(l=>({...l,platforms:l.platforms.includes(i)?l.platforms.filter(s=>s!==i):[...l.platforms,i]}))};return t?e.jsx(oe,{children:e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"glass-morphism rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto cinematic-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Add New Game"}),e.jsx("button",{onClick:a,className:"w-10 h-10 bg-black/50 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-black/70 transition-colors",children:"âœ•"})]}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Add From Platform"}),e.jsxs("select",{value:h,onChange:i=>u(i.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none","aria-label":"Select platform to add game from",children:[e.jsx("option",{value:"manual",children:"ðŸ“ Manual Entry"}),e.jsx("option",{value:"steam",children:"ðŸŽ® Steam Search"}),e.jsx("option",{value:"gog",children:"ðŸŽ¯ GOG Search"})]})]}),h==="gog"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search GOG Games"}),e.jsx(se,{onGameSelect:x,placeholder:"Search GOG catalog..."})]}),h==="steam"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Search Steam Games"}),e.jsx("div",{className:"text-gray-400 text-sm p-3 bg-gray-800 rounded-lg",children:"Steam search coming soon! Use Steam Import for full library access."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:d.title,onChange:i=>g(l=>({...l,title:i.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none",placeholder:"Enter game title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Genres"}),e.jsx(ie,{options:q.map(i=>i.name),selected:d.genres,onChange:i=>g(l=>({...l,genres:i})),placeholder:"Select genres..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Moods"}),e.jsx("div",{className:"space-y-2",children:T.map(i=>e.jsxs("label",{className:"flex items-center space-x-2 text-gray-300 cursor-pointer hover:text-white transition-colors",children:[e.jsx("input",{type:"checkbox",checked:d.moods.includes(i.id),onChange:l=>{l.target.checked?g(s=>({...s,moods:[...s.moods,i.id]})):g(s=>({...s,moods:s.moods.filter(y=>y!==i.id)}))},className:"rounded border-gray-600 bg-gray-700 text-blue-500 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("span",{children:i.name}),e.jsx("span",{className:"text-gray-500 text-sm",children:i.emoji})]},i.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Platforms"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["steam","epic","gog"].map(i=>e.jsxs("label",{className:"flex items-center space-x-2 text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:d.platforms.includes(i),onChange:()=>b(i),className:"rounded border-gray-600 bg-gray-700 text-gaming-primary focus:ring-gaming-primary"}),e.jsx("span",{className:"text-sm capitalize",children:i})]},i))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{value:d.status,onChange:i=>g(l=>({...l,status:i.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none","aria-label":"Select game status",children:[e.jsx("option",{value:"backlog",children:"ðŸ“š Backlog"}),e.jsx("option",{value:"playing",children:"ðŸŽ® Playing"}),e.jsx("option",{value:"completed",children:"âœ… Completed"}),e.jsx("option",{value:"abandoned",children:"ðŸš« Abandoned"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Launcher ID"}),e.jsx("input",{type:"text",value:d.launcherId,onChange:i=>g(l=>({...l,launcherId:i.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none",placeholder:"Steam App ID, Epic Catalog ID, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tags"}),e.jsx(ne,{selected:d.tags,onChange:i=>g(l=>({...l,tags:i})),placeholder:"Select or add tags..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Cover Image URL"}),e.jsx("input",{type:"url",value:d.coverImage,onChange:i=>g(l=>({...l,coverImage:i.target.value})),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none",placeholder:"https://example.com/cover.jpg"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:a,className:"px-6 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-gradient-to-r from-gaming-primary to-gaming-secondary text-white rounded-lg hover:opacity-90 transition-opacity",children:"Add Game"})]})]})]})})})}):null},ce=({size:t="md",className:a=""})=>{const r={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8",xl:"w-12 h-12"};return e.jsx("div",{className:`inline-block animate-spin ${r[t]} ${a}`,children:e.jsxs("svg",{className:"w-full h-full text-gaming-primary",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},de=({children:t,message:a="Loading...",size:r="lg",fullScreen:c=!1,className:m=""})=>{const d=e.jsxs("div",{className:`flex flex-col items-center justify-center space-y-4 ${m}`,children:[e.jsx(ce,{size:r}),a&&e.jsx("p",{className:"text-gray-300 text-center animate-pulse",children:a}),t]});return c?e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-gaming-dark via-gray-900 to-gaming-darker z-50 flex items-center justify-center",children:e.jsx("div",{className:"glass-morphism rounded-xl p-8 border border-white/10",children:d})}):d},me=({isOpen:t,onClose:a,onImportGames:r})=>{const[c,m]=p.useState(""),[d,g]=p.useState(""),[h,u]=p.useState(""),[x,v]=p.useState(!1),{actions:b,isLoading:i,games:l}=L(),{user:s}=W();p.useEffect(()=>{if(s!=null&&s.steamId||s!=null&&s.steamProfile){const n=(s==null?void 0:s.steamId)||((s==null?void 0:s.steamProfile)||"").split("/").pop();n&&(m(n),console.log("ðŸŽ¯ Auto-filled Steam ID from logged-in user:",n))}},[s]);const y=async()=>{if(console.log("ðŸŽ® SteamImportModal: handleImport called!"),console.log("ðŸŽ® SteamImportModal: Steam ID:",c),console.log("ðŸŽ® SteamImportModal: Force re-import:",x),!c){console.log("ðŸŽ® SteamImportModal: No Steam ID provided"),g("Steam ID is required"),u("Please try logging in with Steam again");return}console.log("ðŸŽ® SteamImportModal: Starting import process..."),g("Fetching your Steam library..."),u("");try{const n="FBB124C9352519E8F9FE820ADF0DA87C";console.log("ðŸŽ® SteamImportModal: Calling importSteamLibrary with Steam ID:",c);const o=await b.importSteamLibrary(c,n,x);console.log("ðŸŽ® SteamImportModal: Import result:",o),o.success&&o.gameCount>0?(console.log("ðŸŽ® SteamImportModal: Import successful! Games:",o.gameCount),g(`Successfully imported ${o.gameCount} games!`),console.log("ðŸŽ® SteamImportModal: Calling onImportGames callback with",o.games.length,"games"),r(o.games.map(f=>({...f,id:f.id}))),setTimeout(()=>{console.log("ðŸŽ® SteamImportModal: Closing modal..."),a(),g(""),u(""),m("")},2e3)):(console.log("ðŸŽ® SteamImportModal: No games found"),g("No games found in your Steam library"),u("Make sure your Steam profile is public and you own games"))}catch(n){console.error("ðŸŽ® SteamImportModal: Import error:",n);let o="Unknown error occurred",f="Please try again later";n instanceof Error?(o=n.message,console.log("ðŸŽ® SteamImportModal: Error message:",o),console.log("ðŸŽ® SteamImportModal: Error stack:",n.stack)):typeof n=="string"?o=n:n&&typeof n=="object"&&(o="Steam API request failed",f=JSON.stringify(n,null,2),console.log("ðŸŽ® SteamImportModal: Error object:",n)),o.includes("Invalid Steam Web API key")?(g("Invalid API Key"),u("Please check your Steam Web API key and try again")):o.includes("Steam profile is private")?(g("Private Profile"),u("Please make your Steam profile public and set your game details to public")):o.includes("Invalid Steam ID")?(g("Invalid Steam ID"),u("Please check your Steam ID and ensure your profile is public")):o.includes("Failed to connect")||o.includes("Failed to fetch")?(g("Connection Error"),u("Unable to connect to Steam API. Please check your internet connection and try again.")):o.includes("Steam API request failed")?(g("API Error"),u("Steam API is temporarily unavailable. Please try again in a few minutes.")):(g("Import Failed"),u(`${o}. ${f}`))}finally{console.log("ðŸŽ® SteamImportModal: Import process completed")}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"glass-morphism rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto cinematic-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Import Steam Library"}),e.jsx("button",{onClick:a,className:"w-10 h-10 bg-black/50 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-black/70 transition-colors",children:"âœ•"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Steam ID"}),e.jsx("input",{type:"text",value:c,onChange:n=>m(n.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-gaming-accent focus:outline-none",placeholder:"Your Steam ID (auto-filled from login)",disabled:i||!!(s!=null&&s.steamId)||!!(s!=null&&s.steamProfile)}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:s!=null&&s.steamId||s!=null&&s.steamProfile?"Steam ID auto-filled from your login":"Find your Steam ID in your profile URL"})]}),e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-3 mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"Import Your Steam Library"}),e.jsx("p",{className:"text-xs text-gray-400 mb-3",children:'Click "Import Library" to fetch all games from your Steam account. This will import game titles, playtime, achievements, and cover images.'}),l.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"forceReimport",checked:x,onChange:n=>v(n.target.checked),className:"w-4 h-4 text-gaming-accent bg-gray-700 border-gray-600 rounded focus:ring-gaming-accent focus:ring-2"}),e.jsx("label",{htmlFor:"forceReimport",className:"text-xs text-gray-300",children:"Force re-import (update existing games)"})]})]}),(d||h)&&e.jsxs("div",{className:`p-3 rounded-lg text-sm ${d.includes("Successfully")?"bg-green-600/20 text-green-400 border border-green-600/50":"bg-red-600/20 text-red-400 border border-red-600/50"}`,children:[e.jsxs("div",{className:"font-medium flex items-center gap-2",children:[i&&e.jsx(de,{}),d]}),h&&e.jsx("div",{className:"text-xs mt-1 opacity-75",children:h})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,disabled:i,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:y,disabled:i||!c,className:"flex-1 px-4 py-2 bg-gradient-to-r from-gaming-primary to-gaming-secondary text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Importing...":"Import Library"})]})]})]})})}):null},ge=()=>e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden animate-pulse",children:[e.jsx("div",{className:"aspect-[3/4] bg-gray-700"}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"h-4 bg-gray-700 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-700 rounded w-1/2"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-6 w-6 bg-gray-700 rounded-full"}),e.jsx("div",{className:"h-3 bg-gray-700 rounded w-16"})]})]})]}),pe=({count:t=12})=>e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-6",children:Array.from({length:t}).map((a,r)=>e.jsx(ge,{},r))}),R={adrenaline:["intense","competitive","high-energy","action-packed"],"brain-power":["strategic","puzzle","thinking","tactical"],zen:["relaxing","cozy","atmospheric","wholesome"],story:["narrative","story-rich","immersive","adventure"],social:["multiplayer","cooperative","party","team-based"],creative:["building","crafting","sandbox","artistic"],nostalgic:["retro","classic","remastered","throwback"],scary:["horror","scary","terrifying"]},be=()=>{const{games:t,actions:a,intelligence:r,setIntelligenceState:c}=L(),[m,d]=p.useState(!0);p.useEffect(()=>{console.log("ðŸŽ® Loading library..."),a.loadGames()},[a]),p.useEffect(()=>{t!==null&&d(!1)},[t]),p.useEffect(()=>{console.log("ðŸ§¹ Library component mounted - clearing mood cache..."),O(),t&&t.length>0&&(console.log("ðŸ”„ Forcing re-evaluation of all game moods..."),t.forEach(o=>{o.moods&&Array.isArray(o.moods)&&delete o.moods}))},[t]);const[g,h]=p.useState(""),[u,x]=p.useState([]);p.useState(!1);const[v,b]=p.useState(!1),[i,l]=p.useState(!1),s=p.useMemo(()=>{console.log("ðŸ” DEBUG: Raw games count:",(t==null?void 0:t.length)||0);const o=t!=null&&t.length?K(t):[];if(console.log("ðŸ” DEBUG: Normalized games count:",o.length),o.length>0){console.log("ðŸ” DEBUG: Testing mood assignment on first game...");const f=o[0];console.log("ðŸ” DEBUG: First game before mood assignment:",{title:f.title,currentMoods:f.moods,genres:f.genres})}return o},[t]),y=p.useMemo(()=>{let o=[...s];console.log("ðŸ“Š MOOD DISTRIBUTION ANALYSIS:");const f={},k={};if(o.forEach(N=>{(Array.isArray(N.moods)?N.moods:[]).forEach(j=>{f[j]=(f[j]||0)+1}),(Array.isArray(N.genres)?N.genres.map(j=>j.name||j):[]).forEach(j=>{k[j]=(k[j]||0)+1})}),console.log("ðŸŽ­ Mood Distribution:",f),console.log("ðŸŽ® Genre Distribution:",k),console.log("ðŸ“ˆ Total Games:",o.length),g.trim()!==""){const N=g.toLowerCase();o=o.filter(S=>{var I;return(I=S.title)==null?void 0:I.toLowerCase().includes(N)})}return r.selectedMasterMood&&(console.log(`ðŸ” DEBUG: Filtering for ${r.selectedMasterMood}`),console.log("ðŸ” DEBUG: Allowed sub-moods:",R[r.selectedMasterMood]),o=o.filter(N=>{const S=Array.isArray(N.moods)?N.moods:[],I=String(r.selectedMasterMood).toLowerCase(),j=(R[r.selectedMasterMood]||[]).map(w=>String(w).toLowerCase()),M=[I,...j],C=S.some(w=>M.includes(String(w).toLowerCase()));return(r.selectedMasterMood==="social"||r.selectedMasterMood==="creative"||r.selectedMasterMood==="nostalgic")&&console.log(`ðŸ” DEBUG: Game "${N.title}" - Moods: [${S.join(", ")}] - Match: ${C}`),C}),console.log(`ðŸ” DEBUG: Filtered from ${s.length} to ${o.length} games for ${r.selectedMasterMood}`)),o.sort((N,S)=>{switch(r.selectedSorting){case"rating":return(S.globalRating||0)-(N.globalRating||0);case"playtime":return(S.hoursPlayed||0)-(N.hoursPlayed||0);case"title":default:return(N.title||"").localeCompare(S.title||"")}}),o},[s,g,r.selectedMasterMood,r.selectedSorting]),n=o=>{x(f=>f.includes(o)?f.filter(k=>k!==o):[...f,o])};return e.jsx("div",{className:"min-h-screen bg-gaming-dark text-white",children:e.jsxs("div",{className:"container mx-auto px-6 py-12",children:[e.jsxs("header",{className:"flex flex-col md:flex-row md:items-end justify-between gap-6 mb-12",children:[e.jsxs("div",{children:[e.jsx(A.h1,{className:"text-5xl font-gaming font-bold bg-gradient-to-r from-gaming-primary to-gaming-accent bg-clip-text text-transparent mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:"Your Library"}),e.jsx("p",{className:"text-gray-400 text-lg max-w-xl",children:"Managed collection with normalized intelligence."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>l(!0),className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl hover:bg-white/10 transition-all flex items-center gap-3",children:[e.jsx("span",{children:"ðŸ”—"})," Import Steam"]}),e.jsx("button",{onClick:()=>b(!0),className:"px-6 py-3 bg-gaming-primary text-white rounded-xl shadow-lg font-bold",children:"+ Add Game"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10",children:[e.jsx("aside",{className:"lg:col-span-3 space-y-8",children:e.jsxs("div",{className:"gaming-card rounded-2xl p-6 border border-white/5 sticky top-24 bg-gray-900/50 backdrop-blur-md",children:[e.jsxs("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-widest mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"text-gaming-primary text-lg",children:"ðŸ§ "})," Intelligence"]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:"Mood"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:V.map(o=>e.jsxs("button",{onClick:()=>c({...r,selectedMasterMood:r.selectedMasterMood===o.id?"":o.id}),className:`px-3 py-2 rounded-lg text-[10px] font-black uppercase transition-all border ${r.selectedMasterMood===o.id?"bg-gaming-primary/20 border-gaming-primary text-gaming-primary":"bg-white/5 border-transparent text-gray-400 hover:bg-white/10"}`,children:[e.jsx("span",{className:"text-4xl mb-2",children:o.emoji}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-tighter",children:o.name})]},o.id))})]}),e.jsx("button",{onClick:()=>c({selectedMasterMood:"",selectedSorting:"title"}),className:"w-full py-3 text-xs font-bold text-gray-500 hover:text-white transition-colors",children:"Reset Filters"}),e.jsx("button",{onClick:()=>{O(),window.location.reload()},className:"w-full mt-2 py-3 text-xs font-bold text-gaming-primary hover:text-white transition-colors border border-gaming-primary/20 rounded",children:"ðŸ§¹ Clear Mood Cache"})]})}),e.jsxs("main",{className:"lg:col-span-9 space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-white/5 to-white/10 backdrop-blur-md rounded-2xl border border-white/10 p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-center justify-between",children:[e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500",children:"ðŸ”"}),e.jsx("input",{type:"text",placeholder:"Search collection...",value:g,onChange:o=>h(o.target.value),className:"w-full pl-12 pr-4 py-3 bg-gray-900 rounded-xl border border-white/10 focus:ring-2 focus:ring-gaming-primary/50 outline-none"})]}),e.jsxs("select",{value:r.selectedSorting,onChange:o=>c({...r,selectedSorting:o.target.value}),className:"bg-gray-900 text-sm font-bold text-gray-300 border border-white/10 rounded-lg px-4 py-3 outline-none",title:"Sort games by",children:[e.jsx("option",{value:"title",children:"Alphabetical"}),e.jsx("option",{value:"rating",children:"Top Rated"}),e.jsx("option",{value:"playtime",children:"Most Played"})]})]})}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md rounded-2xl border border-white/10 p-6 min-h-[500px]",children:[m?e.jsx(pe,{count:12}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:y.map(o=>e.jsx(re,{game:o,onSelect:()=>n(o.id),onLaunch:f=>{f.appId?a.launchGame(f.appId.toString()):console.warn("No appId found for game:",f.title)}},o.id))}),!m&&y.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx("span",{className:"text-4xl mb-4",children:"ðŸŽ®"}),e.jsx("p",{children:"No games match these criteria."})]})]})]})]}),e.jsxs(_,{children:[v&&e.jsx(le,{isOpen:v,onClose:()=>b(!1),onAddGame:o=>{a.setGames([...t,{...o,id:crypto.randomUUID()}]),b(!1)}}),i&&e.jsx(me,{isOpen:i,onClose:()=>l(!1),onImportGames:o=>{a.setGames([...t,...o]),l(!1)}})]})]})})};export{be as Library,be as default};
