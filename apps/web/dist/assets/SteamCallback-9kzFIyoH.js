import{i as y,u as S,f as h,r as v,j as l}from"./index-2zxZw9Mw.js";import{u as x}from"./useLibraryStore-BvHGHpT8.js";function A(){const[a]=y(),n=S(),{setUser:g,setAuthenticated:u}=h(),{actions:i}=x();return v.useEffect(()=>{const o=a.get("sessionToken"),t=a.get("userId"),d=a.get("steamId"),s=a.get("displayName"),p=a.get("avatar"),c=a.get("loginError");if(console.log("ğŸ”„ Steam callback params:",{sessionToken:o,userId:t,steamId:d,displayName:s,avatar:p,error:c}),console.log("ğŸ” Full URL params object:",a),console.log("ğŸ” All available params:",Array.from(a.entries())),o&&t&&s){localStorage.setItem("sessionToken",o),console.log("ğŸ’¾ Stored session token:",o.substring(0,10)+"...");const m={id:t,username:s,displayName:s,avatar:p||"",steamId:d||t,personaName:s};localStorage.setItem("user",JSON.stringify(m)),console.log("ğŸ’¾ Stored user data:",m),g(m),u(!0),console.log("âœ… Updated auth store with user data"),(async()=>{try{console.log("ğŸ® Auto-importing Steam library for user:",t);const r=await i.importSteamLibrary(t,"FBB124C9352519E8F9FE820ADF0DA87C");if(r.success&&r.gameCount>0){console.log(`âœ… Auto-imported ${r.gameCount} Steam games!`);const f=r.games.map(e=>({...e,id:e.steamAppId||e.id,platforms:e.platforms||["Steam"],genres:e.genres||[],coverImage:e.coverImage||e.header_image,playStatus:e.playStatus||"backlog",isFavorite:!1,addedAt:new Date,hoursPlayed:e.hoursPlayed||0,userRating:e.userRating,globalRating:e.globalRating,releaseYear:e.releaseYear}));i.setGames(f),console.log("ğŸ¯ Steam games added to library:",f.length)}else console.log("â„¹ï¸ No Steam games found to import")}catch(b){console.error("âŒ Auto-import failed:",b),console.log("âš ï¸ Navigating to library despite import error")}})(),console.log("âœ… Steam callback processed successfully"),setTimeout(()=>{console.log("ğŸš€ Navigating to /library"),n("/library")},1e3)}else console.error("âŒ Steam login failed:",c),n("/login?error="+(c||"unknown"))},[a,n,g,u,i]),l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gaming-dark via-gray-900 to-gaming-darker flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),l.jsx("p",{className:"text-white text-lg",children:"Processing Steam authentication..."})]})})}export{A as default};
