import{b as j,r as g,j as s,c as w,d as k,p as S}from"./index-db369dc9.js";import{u as f,a as b}from"./customisationStore-40fc727e.js";import"./useCurrentMood-a662386a.js";import{u as N}from"./useLibraryStore-cd6ac89d.js";import{u as C}from"./useLibraryPersona-9e7a4be7.js";const A=()=>{const{user:t}=j(),[a,e]=g.useState({hasApiKey:!1,maskedKey:null,isLoading:!1,error:null}),i=async()=>{try{e(r=>({...r,isLoading:!0,error:null}));const n=await fetch("/api/auth/steam-api-key",{method:"GET",credentials:"include"});if(n.ok){const r=await n.json();e({hasApiKey:r.hasApiKey,maskedKey:r.maskedKey,isLoading:!1,error:null})}else throw new Error("Failed to load Steam API key")}catch(n){e(r=>({...r,isLoading:!1,error:n instanceof Error?n.message:"Unknown error"}))}},d=async n=>{try{e(m=>({...m,isLoading:!0,error:null}));const r=await fetch("/api/auth/steam-api-key",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({apiKey:n})});if(r.ok){const m=await r.json();e({hasApiKey:!0,maskedKey:m.maskedKey,isLoading:!1,error:null})}else throw new Error("Failed to update Steam API key")}catch(r){e(m=>({...m,isLoading:!1,error:r instanceof Error?r.message:"Unknown error"}))}},l=async()=>{try{if(e(r=>({...r,isLoading:!0,error:null})),(await fetch("/api/auth/steam-api-key",{method:"DELETE",credentials:"include"})).ok)e({hasApiKey:!1,maskedKey:null,isLoading:!1,error:null});else throw new Error("Failed to delete Steam API key")}catch(n){e(r=>({...r,isLoading:!1,error:n instanceof Error?n.message:"Unknown error"}))}};return g.useEffect(()=>{t&&i()},[t]),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gaming-text",children:"Steam API"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("input",{type:"password",placeholder:"Enter Steam API Key",className:"w-full p-2 bg-gaming-surface border border-gaming-border rounded-lg text-gaming-text",onChange:n=>d(n.target.value)}),a.error&&s.jsx("div",{className:"mb-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg",children:s.jsxs("p",{className:"text-red-400 text-sm",children:["âŒ ",a.error]})}),a.hasApiKey?s.jsx("div",{className:"space-y-3",children:s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg",children:[s.jsxs("span",{className:"text-sm text-gaming-text",children:["API Key: ",a.maskedKey]}),s.jsx("button",{onClick:l,className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm",disabled:a.isLoading,children:"Remove"})]})}):s.jsx("p",{className:"text-sm text-gaming-text-muted",children:"Add your Steam API key to sync your game library"})]})]})};let c={steamConnected:!1,discordConnected:!1,youtubeConnected:!1,gogConnected:!1,epicConnected:!1};const p={async getIntegrations(){return await new Promise(t=>setTimeout(t,100)),{...c}},async setIntegrations(t){return await new Promise(a=>setTimeout(a,100)),c={...c,...t},{...c}},async connectSteam(){await new Promise(a=>setTimeout(a,1500));const t={success:!0,username:"DemoUser",avatarUrl:"/demo.jpg"};return c.steamConnected=!0,c.steamUsername=t.username,c.steamAvatarUrl=t.avatarUrl,t},async disconnectSteam(){return await new Promise(t=>setTimeout(t,500)),c.steamConnected=!1,delete c.steamUsername,delete c.steamAvatarUrl,{success:!0}},async connectDiscord(){await new Promise(a=>setTimeout(a,1e3));const t={success:!0,username:"DemoUser#1234"};return c.discordConnected=!0,c.discordUsername=t.username,t},async disconnectDiscord(){return await new Promise(t=>setTimeout(t,500)),c.discordConnected=!1,delete c.discordUsername,{success:!0}}},y={steamConnected:!1,discordConnected:!1,youtubeConnected:!1,gogConnected:!1,epicConnected:!1},v=w()(k(S((t,a)=>({...y,setIntegration:(e,i)=>t(()=>({[e]:i})),setIntegrationData:(e,i)=>t(()=>({[e]:i})),loadIntegrationsFromServer:async()=>{try{const e=await p.getIntegrations();t(e)}catch(e){console.error("Failed to load integrations from server:",e)}},syncIntegrationsToServer:async()=>{try{const e=a();await p.setIntegrations(e)}catch(e){console.error("Failed to sync integrations to server:",e)}},resetIntegrations:()=>t(y),connectSteam:async()=>{try{const e=await p.connectSteam();return t(()=>({steamConnected:e.success,steamUsername:e.username,steamAvatarUrl:e.avatarUrl})),e}catch(e){throw console.error("Failed to connect Steam:",e),e}},disconnectSteam:async()=>{try{const e=await p.disconnectSteam();return t(()=>({steamConnected:!1,steamUsername:void 0,steamAvatarUrl:void 0})),e}catch(e){throw console.error("Failed to disconnect Steam:",e),e}},connectDiscord:async()=>{try{const e=await p.connectDiscord();return t(()=>({discordConnected:e.success,discordUsername:e.username})),e}catch(e){throw console.error("Failed to connect Discord:",e),e}},disconnectDiscord:async()=>{try{const e=await p.disconnectDiscord();return t(()=>({discordConnected:!1,discordUsername:void 0})),e}catch(e){throw console.error("Failed to disconnect Discord:",e),e}}}),{name:"gamepilot-integrations",version:1}),{name:"integrations-store"})),I=()=>{const t=v();return{steamConnected:t.steamConnected,discordConnected:t.discordConnected,youtubeConnected:t.youtubeConnected,gogConnected:t.gogConnected,epicConnected:t.epicConnected,steamUsername:t.steamUsername,steamAvatarUrl:t.steamAvatarUrl,discordUsername:t.discordUsername,youtubeChannelId:t.youtubeChannelId,gogUsername:t.gogUsername,epicUsername:t.epicUsername}},D=()=>{const t=v();return{setIntegration:t.setIntegration,setIntegrationData:t.setIntegrationData,loadIntegrationsFromServer:t.loadIntegrationsFromServer,syncIntegrationsToServer:t.syncIntegrationsToServer,resetIntegrations:t.resetIntegrations,connectSteam:t.connectSteam,disconnectSteam:t.disconnectSteam,connectDiscord:t.connectDiscord,disconnectDiscord:t.disconnectDiscord}},U=()=>{var l;const t=I(),{updateIntegration:a}=D(),[e,i]=g.useState({discordBotToken:((l=t.discord)==null?void 0:l.botToken)||""}),d=(n,r)=>{i(m=>({...m,[n]:r})),a("discord",{botToken:r})};return s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gaming-text",children:"Discord Integration"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("input",{id:"discord-bot-token",type:"password",value:e.discordBotToken,onChange:n=>d("discordBotToken",n.target.value),placeholder:"Enter Discord Bot Token",className:"w-full p-2 bg-gaming-surface border border-gaming-border rounded-lg text-gaming-text"}),s.jsx("p",{className:"text-sm text-gaming-text-muted",children:"Connect your Discord bot to enable rich presence and notifications"})]})]})},P=({className:t="",size:a="md"})=>{const{theme:e}=f(),{setGlobalSettings:i}=b(),[d,l]=g.useState(!1);g.useEffect(()=>{l(!0)},[]),g.useEffect(()=>{if(!d)return;const o=document.documentElement;if(e==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";o.setAttribute("data-theme",u)}else o.setAttribute("data-theme",e)},[e,d]),g.useEffect(()=>{if(e!=="system")return;const o=window.matchMedia("(prefers-color-scheme: dark)"),u=h=>{document.documentElement.setAttribute("data-theme",h.matches?"dark":"light")};return o.addEventListener("change",u),()=>o.removeEventListener("change",u)},[e]);const n=()=>{const o=["dark","light","system"],h=(o.indexOf(e)+1)%o.length;i({theme:o[h]})},r=o=>{switch(o){case"dark":return"ðŸŒ™";case"light":return"â˜€ï¸";case"system":return"ðŸŒ“";default:return"ðŸŒ™"}},m=o=>{switch(o){case"dark":return"Dark Mode";case"light":return"Light Mode";case"system":return"Auto Mode";default:return"Dark Mode"}},x={sm:"p-2 text-sm",md:"p-3 text-base",lg:"p-4 text-lg"};return d?s.jsxs("button",{onClick:n,className:`
        glass-morphism rounded-lg border border-white/10 
        hover:bg-white/10 transition-all duration-200
        flex items-center space-x-2 group
        ${x[a]} ${t}
      `,title:`Current: ${m(e)}. Click to change theme.`,children:[s.jsx("span",{className:"text-xl transition-transform duration-300 group-hover:scale-110",children:r(e)}),s.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:m(e)})]}):s.jsx("div",{className:`${x[a]} ${t}`,children:s.jsx("div",{className:"w-6 h-6 bg-gray-700 rounded-full animate-pulse"})})},T=()=>s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gaming-text",children:"Appearance"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gaming-text",children:"Dark Mode"}),s.jsx(P,{})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-gaming-text",children:"Theme Color"}),s.jsxs("select",{className:"w-full p-2 bg-gaming-surface border border-gaming-border rounded-lg text-gaming-text",children:[s.jsx("option",{value:"blue",children:"Gaming Blue"}),s.jsx("option",{value:"green",children:"Matrix Green"}),s.jsx("option",{value:"purple",children:"Cyber Purple"}),s.jsx("option",{value:"red",children:"Neon Red"})]})]})]})]}),E=()=>{var l,n,r,m,x;const t=f(),{updateCustomisation:a}=b(),[e,i]=g.useState({desktop:((l=t.notifications)==null?void 0:l.desktop)??!0,email:((n=t.notifications)==null?void 0:n.email)??!1,discord:((r=t.notifications)==null?void 0:r.discord)??!0,achievements:((m=t.notifications)==null?void 0:m.achievements)??!0,friendRequests:((x=t.notifications)==null?void 0:x.friendRequests)??!0}),d=(o,u)=>{i(h=>({...h,[o]:u})),a("notifications",{...e,[o]:u})};return s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gaming-text",children:"Notifications"}),s.jsx("div",{className:"space-y-3",children:[{key:"desktop",label:"Desktop Notifications"},{key:"email",label:"Email Notifications"},{key:"discord",label:"Discord Notifications"},{key:"achievements",label:"Achievement Notifications"},{key:"friendRequests",label:"Friend Request Notifications"}].map(({key:o,label:u})=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gaming-text",children:u}),s.jsx("input",{type:"checkbox",checked:e[o],onChange:h=>d(o,h.target.checked),className:"w-4 h-4 text-gaming-primary bg-gaming-surface border-gaming-border rounded"})]},o))})]})},K=()=>{C(),N();const[t,a]=g.useState({sharePlaytime:!0,shareAchievements:!1,shareGameLibrary:!1,sharePersona:!1,analyticsEnabled:!0,crashReporting:!0}),e=(i,d)=>{a(l=>({...l,[i]:d}))};return s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gaming-text",children:"Privacy"}),s.jsx("div",{className:"space-y-3",children:[{key:"sharePlaytime",label:"Share Playtime Data",description:"Help improve recommendations by sharing your playtime"},{key:"shareAchievements",label:"Share Achievements",description:"Show off your gaming achievements"},{key:"shareGameLibrary",label:"Share Game Library",description:"Let friends see your game collection"},{key:"sharePersona",label:"Share Gaming Persona",description:"Share your gaming personality profile"},{key:"analyticsEnabled",label:"Analytics",description:"Help us improve GamePilot with usage data"},{key:"crashReporting",label:"Crash Reporting",description:"Automatically report crashes to help us fix bugs"}].map(({key:i,label:d,description:l})=>s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gaming-text",children:d}),s.jsx("input",{type:"checkbox",checked:t[i],onChange:n=>e(i,n.target.checked),className:"w-4 h-4 text-gaming-primary bg-gaming-surface border-gaming-border rounded"})]}),s.jsx("p",{className:"text-xs text-gaming-text-muted",children:l})]},i))})]})},L=({children:t,title:a,description:e})=>s.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-gaming-text mb-2",children:a}),e&&s.jsx("p",{className:"text-gaming-text-muted",children:e})]}),s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:t})]}),q=()=>s.jsxs(L,{title:"Settings",description:"Manage your GamePilot preferences and integrations",children:[s.jsx(A,{}),s.jsx(U,{}),s.jsx(T,{}),s.jsx(E,{}),s.jsx(K,{})]});export{q as SettingsPage,q as default};
