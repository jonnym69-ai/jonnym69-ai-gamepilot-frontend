import{b as j,r as m,j as t,c as v,d as w,p as k}from"./index-2zxZw9Mw.js";import{u as f,a as b}from"./customisationStore-Dw-C3OIT.js";import"./useCurrentMood-DCnI8z6_.js";import{u as N}from"./useLibraryStore-BvHGHpT8.js";import{u as S}from"./useLibraryPersona-BzYMiu7h.js";const A=()=>{const{user:s}=j(),[r,e]=m.useState({hasApiKey:!1,maskedKey:null,isLoading:!1,error:null}),c=async()=>{try{e(n=>({...n,isLoading:!0,error:null}));const a=await fetch("/api/auth/steam-api-key",{method:"GET",credentials:"include"});if(a.ok){const n=await a.json();e({hasApiKey:n.hasApiKey,maskedKey:n.maskedKey,isLoading:!1,error:null})}else throw new Error("Failed to load Steam API key")}catch(a){e(n=>({...n,isLoading:!1,error:a instanceof Error?a.message:"Unknown error"}))}},i=async a=>{try{e(u=>({...u,isLoading:!0,error:null}));const n=await fetch("/api/auth/steam-api-key",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({apiKey:a})});if(n.ok){const u=await n.json();e({hasApiKey:!0,maskedKey:u.maskedKey,isLoading:!1,error:null})}else throw new Error("Failed to update Steam API key")}catch(n){e(u=>({...u,isLoading:!1,error:n instanceof Error?n.message:"Unknown error"}))}},o=async()=>{try{if(e(n=>({...n,isLoading:!0,error:null})),(await fetch("/api/auth/steam-api-key",{method:"DELETE",credentials:"include"})).ok)e({hasApiKey:!1,maskedKey:null,isLoading:!1,error:null});else throw new Error("Failed to delete Steam API key")}catch(a){e(n=>({...n,isLoading:!1,error:a instanceof Error?a.message:"Unknown error"}))}};return m.useEffect(()=>{s&&c()},[s]),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gaming-text",children:"Steam API"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{type:"password",placeholder:"Enter Steam API Key",className:"w-full p-2 bg-gaming-surface border border-gaming-border rounded-lg text-gaming-text",onChange:a=>i(a.target.value)}),r.error&&t.jsx("div",{className:"mb-4 p-3 bg-red-900/20 border border-red-500/30 rounded-lg",children:t.jsxs("p",{className:"text-red-400 text-sm",children:["âŒ ",r.error]})}),r.hasApiKey?t.jsx("div",{className:"space-y-3",children:t.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-900/50 rounded-lg",children:[t.jsxs("span",{className:"text-sm text-gaming-text",children:["API Key: ",r.maskedKey]}),t.jsx("button",{onClick:o,className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded-lg text-sm",disabled:r.isLoading,children:"Remove"})]})}):t.jsx("p",{className:"text-sm text-gaming-text-muted",children:"Add your Steam API key to sync your game library"})]})]})};let d={steamConnected:!1,discordConnected:!1,youtubeConnected:!1,gogConnected:!1,epicConnected:!1};const g={async getIntegrations(){return await new Promise(s=>setTimeout(s,100)),{...d}},async setIntegrations(s){return await new Promise(r=>setTimeout(r,100)),d={...d,...s},{...d}},async connectSteam(){await new Promise(r=>setTimeout(r,1500));const s={success:!0,username:"DemoUser",avatarUrl:"/demo.jpg"};return d.steamConnected=!0,d.steamUsername=s.username,d.steamAvatarUrl=s.avatarUrl,s},async disconnectSteam(){return await new Promise(s=>setTimeout(s,500)),d.steamConnected=!1,delete d.steamUsername,delete d.steamAvatarUrl,{success:!0}},async connectDiscord(){await new Promise(r=>setTimeout(r,1e3));const s={success:!0,username:"DemoUser#1234"};return d.discordConnected=!0,d.discordUsername=s.username,s},async disconnectDiscord(){return await new Promise(s=>setTimeout(s,500)),d.discordConnected=!1,delete d.discordUsername,{success:!0}}},y={steamConnected:!1,discordConnected:!1,youtubeConnected:!1,gogConnected:!1,epicConnected:!1},C=v()(w(k((s,r)=>({...y,setIntegration:(e,c)=>s(()=>({[e]:c})),setIntegrationData:(e,c)=>s(()=>({[e]:c})),loadIntegrationsFromServer:async()=>{try{const e=await g.getIntegrations();s(e)}catch(e){console.error("Failed to load integrations from server:",e)}},syncIntegrationsToServer:async()=>{try{const e=r();await g.setIntegrations(e)}catch(e){console.error("Failed to sync integrations to server:",e)}},resetIntegrations:()=>s(y),connectSteam:async()=>{try{const e=await g.connectSteam();return s(()=>({steamConnected:e.success,steamUsername:e.username,steamAvatarUrl:e.avatarUrl})),e}catch(e){throw console.error("Failed to connect Steam:",e),e}},disconnectSteam:async()=>{try{const e=await g.disconnectSteam();return s(()=>({steamConnected:!1,steamUsername:void 0,steamAvatarUrl:void 0})),e}catch(e){throw console.error("Failed to disconnect Steam:",e),e}},connectDiscord:async()=>{try{const e=await g.connectDiscord();return s(()=>({discordConnected:e.success,discordUsername:e.username})),e}catch(e){throw console.error("Failed to connect Discord:",e),e}},disconnectDiscord:async()=>{try{const e=await g.disconnectDiscord();return s(()=>({discordConnected:!1,discordUsername:void 0})),e}catch(e){throw console.error("Failed to disconnect Discord:",e),e}}}),{name:"gamepilot-integrations",version:1}),{name:"integrations-store"})),D=()=>{C();const[s,r]=m.useState({discordBotToken:""}),e=(c,i)=>{r(o=>({...o,[c]:i})),console.log("Discord bot token updated:",i)};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gaming-text",children:"Discord Integration"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("input",{id:"discord-bot-token",type:"password",value:s.discordBotToken,onChange:c=>e("discordBotToken",c.target.value),placeholder:"Enter Discord Bot Token",className:"w-full p-2 bg-gaming-surface border border-gaming-border rounded-lg text-gaming-text"}),t.jsx("p",{className:"text-sm text-gaming-text-muted",children:"Connect your Discord bot to enable rich presence and notifications"})]})]})},P=({className:s="",size:r="md"})=>{const{theme:e}=f(),{setGlobalSettings:c}=b(),[i,o]=m.useState(!1);m.useEffect(()=>{o(!0)},[]),m.useEffect(()=>{if(!i)return;const l=document.documentElement;if(e==="system"){const h=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";l.setAttribute("data-theme",h)}else l.setAttribute("data-theme",e)},[e,i]),m.useEffect(()=>{if(e!=="system")return;const l=window.matchMedia("(prefers-color-scheme: dark)"),h=p=>{document.documentElement.setAttribute("data-theme",p.matches?"dark":"light")};return l.addEventListener("change",h),()=>l.removeEventListener("change",h)},[e]);const a=()=>{const l=["dark","light","system"],p=(l.indexOf(e)+1)%l.length;c({theme:l[p]})},n=l=>{switch(l){case"dark":return"ðŸŒ™";case"light":return"â˜€ï¸";case"system":return"ðŸŒ“";default:return"ðŸŒ™"}},u=l=>{switch(l){case"dark":return"Dark Mode";case"light":return"Light Mode";case"system":return"Auto Mode";default:return"Dark Mode"}},x={sm:"p-2 text-sm",md:"p-3 text-base",lg:"p-4 text-lg"};return i?t.jsxs("button",{onClick:a,className:`
        glass-morphism rounded-lg border border-white/10 
        hover:bg-white/10 transition-all duration-200
        flex items-center space-x-2 group
        ${x[r]} ${s}
      `,title:`Current: ${u(e)}. Click to change theme.`,children:[t.jsx("span",{className:"text-xl transition-transform duration-300 group-hover:scale-110",children:n(e)}),t.jsx("span",{className:"text-gray-300 group-hover:text-white transition-colors",children:u(e)})]}):t.jsx("div",{className:`${x[r]} ${s}`,children:t.jsx("div",{className:"w-6 h-6 bg-gray-700 rounded-full animate-pulse"})})},T=()=>t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gaming-text",children:"Appearance"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gaming-text",children:"Dark Mode"}),t.jsx(P,{})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-gaming-text",children:"Theme Color"}),t.jsxs("select",{className:"w-full p-2 bg-gaming-surface border border-gaming-border rounded-lg text-gaming-text",title:"Select theme color","aria-label":"Select theme color",children:[t.jsx("option",{value:"blue",children:"Gaming Blue"}),t.jsx("option",{value:"green",children:"Matrix Green"}),t.jsx("option",{value:"purple",children:"Cyber Purple"}),t.jsx("option",{value:"red",children:"Neon Red"})]})]})]})]}),E=()=>{const s=f(),{updateCustomisation:r}=b(),[e,c]=m.useState({desktop:s.notifications?.desktop??!0,email:s.notifications?.email??!1,discord:s.notifications?.discord??!0,achievements:s.notifications?.achievements??!0,friendRequests:s.notifications?.friendRequests??!0}),i=(o,a)=>{c(n=>({...n,[o]:a})),r("notifications",{...e,[o]:a})};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gaming-text",children:"Notifications"}),t.jsx("div",{className:"space-y-3",children:[{key:"desktop",label:"Desktop Notifications"},{key:"email",label:"Email Notifications"},{key:"discord",label:"Discord Notifications"},{key:"achievements",label:"Achievement Notifications"},{key:"friendRequests",label:"Friend Request Notifications"}].map(({key:o,label:a})=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gaming-text",children:a}),t.jsx("input",{type:"checkbox",checked:e[o],onChange:n=>i(o,n.target.checked),className:"w-4 h-4 text-gaming-primary bg-gaming-surface border-gaming-border rounded",title:`Toggle ${a}`,"aria-label":`Toggle ${a}`})]},o))})]})},I=()=>{S();const{games:s}=N(),[r,e]=m.useState({sharePlaytime:!0,shareAchievements:!1,shareGameLibrary:!1,sharePersona:!1,analyticsEnabled:!0,crashReporting:!0}),c=(i,o)=>{e(a=>({...a,[i]:o}))};return t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gaming-text",children:"Privacy"}),t.jsx("div",{className:"space-y-3",children:[{key:"sharePlaytime",label:"Share Playtime Data",description:"Help improve recommendations by sharing your playtime"},{key:"shareAchievements",label:"Share Achievements",description:"Show off your gaming achievements"},{key:"shareGameLibrary",label:"Share Game Library",description:"Let friends see your game collection"},{key:"sharePersona",label:"Share Gaming Persona",description:"Share your gaming personality profile"},{key:"analyticsEnabled",label:"Analytics",description:"Help us improve GamePilot with usage data"},{key:"crashReporting",label:"Crash Reporting",description:"Automatically report crashes to help us fix bugs"}].map(({key:i,label:o,description:a})=>t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-gaming-text",children:o}),t.jsx("input",{type:"checkbox",checked:r[i],onChange:n=>c(i,n.target.checked),className:"w-4 h-4 text-gaming-primary bg-gaming-surface border-gaming-border rounded",title:`Toggle ${o}`,"aria-label":`Toggle ${o}`})]}),t.jsx("p",{className:"text-xs text-gaming-text-muted",children:a})]},i))})]})},K=({children:s,title:r,description:e})=>t.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-gaming-text mb-2",children:r}),e&&t.jsx("p",{className:"text-gaming-text-muted",children:e})]}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:s})]}),$=()=>t.jsxs(K,{title:"Settings",description:"Manage your GamePilot preferences and integrations",children:[t.jsx(A,{}),t.jsx(D,{}),t.jsx(T,{}),t.jsx(E,{}),t.jsx(I,{})]});export{$ as SettingsPage,$ as default};
