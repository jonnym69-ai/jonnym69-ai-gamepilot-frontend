var j=Object.defineProperty;var N=(r,t,e)=>t in r?j(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var b=(r,t,e)=>(N(r,typeof t!="symbol"?t+"":t,e),e);import{_ as P,h as R,c as U,a as _,l as G}from"./index-db369dc9.js";const B=[{id:"action",name:"Action",description:"Fast-paced games emphasizing physical challenges",icon:"âš”ï¸",color:"from-red-500 to-orange-600",tags:["fast-paced","intense","reflexes","combat"]},{id:"adventure",name:"Adventure",description:"Games focused on exploration and storytelling",icon:"ðŸ—ºï¸",color:"from-green-500 to-emerald-600",tags:["exploration","story","discovery","puzzle"]},{id:"rpg",name:"RPG",description:"Role-playing games with character progression",icon:"ðŸ‰",color:"from-purple-500 to-pink-600",tags:["character-development","story-rich","strategy","fantasy"]},{id:"strategy",name:"Strategy",description:"Games requiring tactical thinking and planning",icon:"â™Ÿï¸",color:"from-blue-500 to-indigo-600",tags:["tactical","planning","resource-management","thinking"]},{id:"simulation",name:"Simulation",description:"Games that simulate real-world activities",icon:"ðŸ—ï¸",color:"from-yellow-500 to-amber-600",tags:["realistic","management","building","lifelike"]},{id:"sports",name:"Sports",description:"Games based on athletic competitions",icon:"âš½",color:"from-cyan-500 to-teal-600",tags:["competitive","athletic","team-based","physical"]},{id:"racing",name:"Racing",description:"Games focused on speed and vehicle control",icon:"ðŸŽï¸",color:"from-pink-500 to-rose-600",tags:["speed","vehicles","competition","precision"]},{id:"puzzle",name:"Puzzle",description:"Games that challenge problem-solving skills",icon:"ðŸ§©",color:"from-indigo-500 to-purple-600",tags:["brain-teaser","logic","problem-solving","clever"]},{id:"platformer",name:"Platformer",description:"Games involving jumping and navigating platforms",icon:"ðŸ¦˜",color:"from-orange-500 to-red-600",tags:["jumping","precision","navigation","skill-based"]},{id:"fps",name:"FPS",description:"First-person shooter games with perspective-based combat",icon:"ðŸŽ¯",color:"from-red-600 to-pink-700",tags:["shooting","first-person","combat","reflexes"]},{id:"moba",name:"MOBA",description:"Multiplayer online battle arena games",icon:"âš”ï¸",color:"from-purple-600 to-indigo-700",tags:["team-based","competitive","strategic","multiplayer"]},{id:"roguelike",name:"Roguelike",description:"Games with procedurally generated levels and permadeath",icon:"ðŸ’€",color:"from-gray-600 to-gray-800",tags:["procedural","challenging","randomized","permadeath"]},{id:"horror",name:"Horror",description:"Games designed to scare and unsettle players",icon:"ðŸ‘»",color:"from-gray-700 to-gray-900",tags:["scary","atmospheric","suspense","dark"]},{id:"indie",name:"Indie",description:"Games developed by independent creators",icon:"ðŸŽ¨",color:"from-lime-500 to-green-600",tags:["unique","creative","independent","experimental"]},{id:"casual",name:"Casual",description:"Easy-to-play games for relaxation",icon:"ðŸŒ¸",color:"from-pink-400 to-purple-500",tags:["relaxing","simple","accessible","time-filler"]},{id:"multiplayer",name:"Multiplayer",description:"Games designed for multiple players",icon:"ðŸ‘¥",color:"from-teal-500 to-cyan-600",tags:["social","teamwork","competitive","community"]}],q={Action:"action",Adventure:"adventure",RPG:"rpg",Strategy:"strategy",Simulation:"simulation",Sports:"sports",Racing:"racing",Indie:"indie",Casual:"casual","Massively Multiplayer":"multiplayer"},T={action:["adrenaline","competitive-drive","power-fantasy"],adventure:["immersive","wanderlust","deep-dive"],casual:["cozy","pick-up-and-play","calming"],fps:["adrenaline","tactical-mindset","competitive-drive"],horror:["atmospheric","survival-instinct","deep-dive"],indie:["creative-flow","atmospheric","immersive"],moba:["competitive-drive","strategic-depth","social-energy"],multiplayer:["social-energy","competitive-drive","pick-up-and-play"],platformer:["pick-up-and-play","brain-tickle","immersive"],puzzle:["brain-tickle","calming","strategic-depth"],rpg:["deep-dive","immersive","wanderlust"],racing:["adrenaline","competitive-drive","pick-up-and-play"],roguelike:["strategic-depth","survival-instinct","brain-tickle"],simulation:["cozy","calming","creative-flow"],sports:["adrenaline","competitive-drive","social-energy"],strategy:["strategic-depth","tactical-mindset","calming"]},O=r=>q[r]||"unknown",J=r=>T[r]||[],H=r=>{var a,s,l,c,n,d,p;const t=((a=r.genres)==null?void 0:a.map(m=>typeof m=="number"?["Action","Adventure","RPG","Strategy","Simulation","Sports","Indie","Casual","Racing","FPS","Horror","Puzzle","Platformer","MOBA","Roguelike","Multiplayer"][m]||"unknown":typeof m=="object"&&m.description?O(m.description):typeof m=="string"?O(m):"unknown"))||[],e=t.length>0?t:["action"],o=Array.from(new Set(e.flatMap(m=>J(m)))),i=e.map(m=>{var u;return{id:m,name:((u=Object.values(B).find(g=>g.id===m))==null?void 0:u.name)||m,description:m+" games",icon:m,color:"#666",tags:[m],subgenres:[]}});return{id:((s=r.appid)==null?void 0:s.toString())||r.steam_appid,title:r.name,description:r.short_description||"",backgroundImages:((l=r.screenshots)==null?void 0:l.map(m=>m.path_full))||[],coverImage:r.header_image||r.img_logo_url||"",developer:((n=(c=r.developers)==null?void 0:c.map(m=>m.name))==null?void 0:n.join(", "))||null,publisher:((p=(d=r.publishers)==null?void 0:d.map(m=>m.name))==null?void 0:p.join(", "))||null,genres:i,subgenres:[],platforms:r.platforms||[],moods:o,playHistory:[],releaseYear:new Date(r.release_date).getFullYear(),appId:r.appid||r.steam_appid}},k={strategy:["strategic","challenging"],rts:["strategic","challenging"],"turn-based":["strategic","mindful"],"4x":["strategic","creative"],"grand strategy":["strategic","challenging"],"tower defense":["strategic"],action:["intense","action-packed","challenging"],fps:["intense","competitive","action-packed"],shooter:["intense","action-packed"],fighting:["intense","challenging","competitive"],"hack and slash":["intense","action-packed","challenging"],"beat em up":["intense","action-packed"],rpg:["story-rich","challenging"],"action rpg":["story-rich","intense"],jrpg:["story-rich","atmospheric"],mmorpg:["social","story-rich"],roguelike:["challenging","experimental"],roguelite:["challenging"],"left 4 dead":["social","cooperative","multiplayer"],"rocket league":["social","multiplayer","competitive"],rust:["social","multiplayer","survival"],dayz:["social","multiplayer","survival"],"apex legends":["social","multiplayer","competitive"],pubg:["social","multiplayer","battle royale"],fortnite:["social","multiplayer","battle royale"],overwatch:["social","multiplayer","team-based"],valheim:["social","multiplayer","cooperative"],"don't starve together":["social","multiplayer","cooperative"],squad:["social","multiplayer","team-based"],"hell let loose":["social","multiplayer","team-based"],battlebit:["social","multiplayer","competitive"],insurgency:["social","multiplayer","tactical"],"hunt: showdown":["social","multiplayer","competitive"],"crab game":["social","multiplayer","party"],"pummel party":["social","multiplayer","party"],terraria:["creative","sandbox","building"],minecraft:["creative","sandbox","building"],starbound:["creative","sandbox","building"],rimworld:["creative","sandbox","strategy"],"project zomboid":["creative","sandbox","survival"],"core keeper":["creative","sandbox","cooperative"],necesse:["creative","sandbox","building"],forager:["creative","sandbox","relaxing"],"garry's mod":["creative","sandbox","experimental"],unturned:["creative","sandbox","survival"],"7 days to die":["creative","sandbox","survival"],"the forest":["creative","sandbox","survival"],"stranded deep":["creative","sandbox","survival"],"green hell":["creative","sandbox","survival"],kenshi:["creative","sandbox","rpg"],"command & conquer":["nostalgic","retro","strategic"],"age of empires":["nostalgic","retro","strategic"],"company of heroes":["nostalgic","retro","strategic"],"star wars":["nostalgic","retro","story-rich"],batman:["nostalgic","retro","action-packed"],fallout:["nostalgic","retro","story-rich"],"dark souls":["nostalgic","retro","challenging"],"metal gear solid":["nostalgic","retro","story-rich"],"resident evil":["nostalgic","retro","horror"],mafia:["nostalgic","retro","story-rich"],lego:["nostalgic","retro","family"],"baldur's gate":["nostalgic","retro","rpg"],witcher:["nostalgic","retro","story-rich"],"god of war":["nostalgic","retro","action-packed"],simulation:["creative","relaxing"],management:["strategic","creative"],tycoon:["creative","strategic"],farming:["relaxing","creative"],multiplayer:["social","multiplayer"],"co-op":["social","cooperative"],cooperative:["social","cooperative"],online:["social","multiplayer"],party:["social","party"],team:["social","team-based"],"battle royale":["competitive","multiplayer"],building:["creative","building"],crafting:["creative","crafting"],sandbox:["creative","sandbox"],creative:["creative","artistic"],construction:["creative","building"],design:["creative","artistic"],retro:["nostalgic","retro"],classic:["nostalgic","classic"],remastered:["nostalgic","remastered"],throwback:["nostalgic","throwback"],"8-bit":["nostalgic","retro"],"16-bit":["nostalgic","retro"],pixel:["nostalgic","retro"],puzzle:["mindful","challenging"],"hidden object":["relaxing","mindful"],"match-3":["relaxing","mindful"],sokoban:["mindful","challenging"],adventure:["story-rich","atmospheric"],"point and click":["story-rich","mindful"],"visual novel":["story-rich","relaxing"],"walking simulator":["atmospheric","relaxing"],sports:["competitive","high-energy"],racing:["high-energy","competitive"],football:["competitive","social"],basketball:["competitive","high-energy"],soccer:["competitive","social"],indie:["experimental"],experimental:["experimental"],family:["social"],educational:["mindful","creative"],music:["creative"],rhythm:["creative","high-energy"],horror:["gritty","atmospheric","challenging"],"survival horror":["challenging","gritty","intense"],thriller:["atmospheric","intense"],arcade:["high-energy","nostalgic"],"dating sim":["social","story-rich"],idle:["relaxing","creative"],clicker:["relaxing","mindful"],"text adventure":["story-rich","mindful"]},F={"left 4 dead":["social","cooperative","multiplayer"],"rocket league":["social","multiplayer","competitive"],rust:["social","multiplayer","survival"],dayz:["social","multiplayer","survival"],"apex legends":["social","multiplayer","competitive"],pubg:["social","multiplayer","battle royale"],fortnite:["social","multiplayer","battle royale"],overwatch:["social","multiplayer","team-based"],valheim:["social","multiplayer","cooperative"],"don't starve together":["social","multiplayer","cooperative"],squad:["social","multiplayer","team-based"],"hell let loose":["social","multiplayer","team-based"],battlebit:["social","multiplayer","competitive"],insurgency:["social","multiplayer","tactical"],"hunt: showdown":["social","multiplayer","competitive"],"crab game":["social","multiplayer","party"],"pummel party":["social","multiplayer","party"],terraria:["creative","sandbox","building"],minecraft:["creative","sandbox","building"],starbound:["creative","sandbox","building"],rimworld:["creative","sandbox","strategy"],"project zomboid":["creative","sandbox","survival"],"core keeper":["creative","sandbox","cooperative"],necesse:["creative","sandbox","building"],forager:["creative","sandbox","relaxing"],"garry's mod":["creative","sandbox","experimental"],unturned:["creative","sandbox","survival"],"7 days to die":["creative","sandbox","survival"],"the forest":["creative","sandbox","survival"],"stranded deep":["creative","sandbox","survival"],"green hell":["creative","sandbox","survival"],kenshi:["creative","sandbox","rpg"],"command & conquer":["nostalgic","retro","strategic"],"age of empires":["nostalgic","retro","strategic"],"company of heroes":["nostalgic","retro","strategic"],"star wars":["nostalgic","retro","story-rich"],batman:["nostalgic","retro","action-packed"],fallout:["nostalgic","retro","story-rich"],"dark souls":["nostalgic","retro","challenging"],"metal gear solid":["nostalgic","retro","story-rich"],"resident evil":["nostalgic","retro","horror"],mafia:["nostalgic","retro","story-rich"],lego:["nostalgic","retro","family"],"baldur's gate":["nostalgic","retro","rpg"],witcher:["nostalgic","retro","story-rich"],"god of war":["nostalgic","retro","action-packed"],civilization:["strategic","challenging"],stronghold:["strategic"],starcraft:["strategic","competitive"],warcraft:["strategic","social"],"total war":["strategic","challenging"],xcom:["strategic","challenging"],"call of duty":["intense","competitive"],battlefield:["intense","competitive"],doom:["intense","action-packed"],quake:["intense","action-packed"],halo:["action-packed","competitive"],skyrim:["story-rich","atmospheric"],"elden ring":["challenging","atmospheric"],"final fantasy":["story-rich","atmospheric"],"silent hill":["gritty","atmospheric"],amnesia:["gritty","atmospheric"],outlast:["gritty","intense"],"dead space":["gritty","intense","challenging"],"hollow knight":["challenging","atmospheric"],celeste:["challenging"],undertale:["story-rich","experimental"],cuphead:["challenging","nostalgic"],"dead cells":["challenging","intense"]},S=new Map;function Y(r){`${r.title}${JSON.stringify(r.genres||[])}`;const t=Array.isArray(r.moods)?r.moods:[];let e=[];console.log(`ðŸ” DEBUG: Processing "${r.title}" - Genres:`,r.genres),console.log("ðŸ” DEBUG: Raw game data:",{title:r.title,genres:r.genres,steamAppId:r.steamAppId,rawGenreData:r.rawGenreData});const o=(r.title||"").toLowerCase();for(const[c,n]of Object.entries(F))o.includes(c)&&(e=[...e,...n],console.log(`ðŸŽ¯ DEBUG: Title pattern "${c}" matched for "${r.title}" - Added moods:`,n));{const c=Array.isArray(r.genres)?r.genres.map(p=>(p==null?void 0:p.name)||p):[],n=c.filter(Boolean).map(p=>String(p).toLowerCase().trim().replace(/\s+/g," "));console.log(`ðŸŽ­ DEBUG: Extracted genres for "${r.title}":`,c);const d=e.length>0;for(const p of n){if(d&&(p==="indie"||p==="experimental"))continue;const m=k[p];if(m){e=[...e,...m],console.log(`ðŸŽ¯ DEBUG: Genre "${p}" matched for "${r.title}" - Added moods:`,m);continue}for(const[u,g]of Object.entries(k))p.includes(u)&&(e=[...e,...g],console.log(`ðŸŽ¯ DEBUG: Genre pattern "${u}" matched for "${r.title}" - Added moods:`,g))}}if(r.emotionalTags){const n=(Array.isArray(r.emotionalTags)?r.emotionalTags:[r.emotionalTags]).filter(Boolean).map(m=>String(m).toLowerCase().trim().replace(/\s+/g,"-")),d={chill:"relaxing",cozy:"relaxing",calm:"relaxing",focused:"strategic",energetic:"high-energy",energy:"high-energy"},p=n.map(m=>d[m]||m);p.length>0&&(e=[...e,...p.slice(0,2)])}let i=[];t.length===1&&t[0]==="relaxing"?i=e.length>0?e:["creative"]:t.length>1?i=[...t,...e]:t.length===1?i=[...t,...e]:i=e.length>0?e:["creative"];let a=[...new Set(i)].slice(0,4);const s=a.map(c=>String(c).toLowerCase());if(s.length===1&&s[0]==="experimental")if(r.emotionalTags&&Array.isArray(r.emotionalTags)&&r.emotionalTags.length>0){const c=r.emotionalTags.filter(Boolean).map(n=>String(n).toLowerCase().trim().replace(/\s+/g,"-")).slice(0,2);a=[...new Set([...c,...a])].slice(0,4)}else a=["creative",...a].slice(0,4);return console.log(`ðŸ§  DEBUG: Final moods for "${r.title}":`,a,`(Old: [${t.join(", ")}] â†’ New: [${e.join(", ")}])`),a}function me(){S.clear(),console.log("ðŸ§¹ Mood cache cleared - games will be re-evaluated")}async function pe(r){const t=`${r.title}_${JSON.stringify(r.genres||[])}`;if(console.log(`ðŸ” DEBUG MOOD ASSIGNMENT for "${r.title}":`,{genres:r.genres,existingMoods:r.moods,cacheKey:t}),S.has(t)){const s=S.get(t);return console.log(`ðŸ“¦ Using cached moods for "${r.title}":`,s),s}let e=[];const o=(r.title||"").toLowerCase();for(const[s,l]of Object.entries(F))o.includes(s)&&(e=[...e,...l]);const i=Array.isArray(r.genres)?r.genres:[];for(const s of i){const l=typeof s=="string"?s:(s.name||s.id||"").toLowerCase();for(const[c,n]of Object.entries(k))l.includes(c)&&(e=[...e,...n])}if(e.length===0)try{e=await W(r)}catch(s){console.warn("Ollama mood assignment failed, using fallback:",s),e=["creative"]}const a=[...new Set(e)].slice(0,3);return S.set(t,a),console.log(`âœ… FINAL MOODS for "${r.title}":`,a),a.length>0?a:["creative"]}async function W(r){const t=`Analyze this game and assign 2-3 appropriate moods from this list: intense, strategic, relaxing, creative, high-energy, atmospheric, challenging, story-rich, competitive, social, experimental, mindful, nostalgic, gritty, surreal, action-packed.

Game Title: ${r.title}
Description: ${r.description||"No description available"}
Genres: ${Array.isArray(r.genres)?r.genres.map(e=>typeof e=="string"?e:e.name).join(", "):"No genres listed"}

Return only the moods as a JSON array, like: ["strategic", "challenging"]`;try{const e=await fetch("http://localhost:11434/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"llama3.2",prompt:t,stream:!1,format:"json"})});if(!e.ok)throw new Error(`Ollama request failed: ${e.status}`);const o=await e.json(),i=JSON.parse(o.response),a=["intense","strategic","relaxing","creative","high-energy","atmospheric","challenging","story-rich","competitive","social","experimental","mindful","nostalgic","gritty","surreal","action-packed"];return i.filter(s=>a.includes(s.toLowerCase()))}catch(e){throw console.error("Ollama mood assignment error:",e),e}}const z=["intense","strategic","relaxing","creative","high-energy","atmospheric","challenging","story-rich","competitive","social","experimental","mindful","nostalgic","gritty","surreal","action-packed","scary"],K=["all-genres","action","adventure","casual","fps","horror","indie","moba","multiplayer","platformer","puzzle","rpg","racing","roguelike","simulation","sports","strategy"];function y(r){if(!r)return"relaxing";if(Array.isArray(r))return y(r[0]);if(typeof r=="object"){const o=r.moodId??r.id??r.name??r.label;return o?y(o):"relaxing"}const t=String(r).toLowerCase().trim().replace(" ","-");return z.includes(t)?t:{calm:"relaxing",chill:"relaxing",peaceful:"relaxing",zen:"relaxing",create:"creative",building:"creative",tactical:"strategic",planning:"strategic",immersive:"atmospheric",difficult:"challenging",hard:"challenging","fast-paced":"high-energy",adrenaline:"high-energy",narrative:"story-rich",pvp:"competitive",versus:"competitive",multiplayer:"social","co-op":"social",retro:"nostalgic",classic:"nostalgic",action:"intense",intense:"intense",strategic:"strategic",relaxing:"relaxing",creative:"creative","high-energy":"high-energy",atmospheric:"atmospheric",challenging:"challenging","story-rich":"story-rich",competitive:"competitive",social:"social",experimental:"experimental",mindful:"mindful",nostalgic:"nostalgic",gritty:"gritty",surreal:"surreal","action-packed":"action-packed"}[t]||t}function V(r){if(!r)return"60";const t=r.toLowerCase();return t==="short"||t==="15"||t==="30"?"30":t==="medium"||t==="60"||t==="90"?"60":t==="long"||t==="120"||t==="180"?"120":t.replace(/\D/g,"")||"60"}function I(r){if(!r||typeof r!="object")return r;const t={...r};t.id=t.id?String(t.id).replace(/\D/g,""):"";try{const e=Y(t);e&&e.length>0?(console.log(`ðŸ§  Smart moods assigned to "${r.title}":`,e),console.log(`ðŸ” OLD MOODS: ${r.moods} â†’ NEW MOODS: ${e}`),t.moods=e):(console.log(`âš ï¸ Smart mood assigner failed for "${r.title}", using fallback`),t.moods=C(t))}catch(e){console.error(`âŒ Error in smart mood assignment for "${r.title}":`,e),t.moods=C(t)}try{const e=(t.title||"").toLowerCase(),o=(t.description||"").toLowerCase(),i=Array.isArray(t.genres)?t.genres.map(l=>$(l)):[],a=[],s={action:["shoot","kill","war","battle","combat","fight","strike","call","duty","assassin","hitman","gun","weapon","battlefield","cod","counter","strike"],adventure:["tomb","raider","uncharted","journey","explor","island","legend","zelda","link","treasure","quest","adventure","mysterious","discover"],rpg:["rpg","role","fantasy","dragon","quest","dungeon","magic","wizard","final","fantasy","skyrim","the","witcher","divinity","baldur","gate","pathfinder"],strategy:["command","empire","civilization","total","war","age","starcraft","company","conquer","tactics","strategy","chess","turn","based"],simulation:["sim","tycoon","city","builder","manager","railroad","zoo","hospital","theme","park","farming","simulator","construction","management"],sports:["football","soccer","nba","fifa","madden","nfl","basketball","racing","drive","need","speed","tennis","golf","wrestling","boxing","hockey"],puzzle:["puzzle","match","candy","saga","tetris","sudoku","crossword","word","block","jewel","gem","brain","logic"],horror:["dead","resident","evil","silent","hill","outlast","fear","scary","dark","zombie","ghost","haunted","survival","horror"],racing:["racing","drive","speed","need","forza","gran","turismo","kart","motorcycle","rally","track","car"],indie:[],fps:["fps","first","person","shooter","arena","quake","doom","halo","destiny","overwatch"],platformer:["platform","jump","mario","sonic","megaman","crash","bandicoot","super","meat","boy"],roguelike:["roguelike","rogue","dungeon","crawler","random","procedural","perma","death","binding","slay"],survival:["survival","craft","minecraft","ark","rust","dayz","7","days","the","forest","wilderness"]};for(const[l,c]of Object.entries(s))c.some(n=>e.includes(n)||o.includes(n))&&(i.includes(l)||a.push(l));a.length>0&&(t.genres=[...i,...a.slice(0,2)],console.log(`ðŸŽ­ Enhanced genres for "${r.title}": Added ${a.join(", ")}`))}catch(e){console.error(`âŒ Error in genre enhancement for "${r.title}":`,e)}return t}function C(r){if(r.moods)return(Array.isArray(r.moods)?r.moods:[r.moods]).map(e=>y(e)).filter((e,o,i)=>e&&i.indexOf(e)===o);if(!r.moods||r.moods.length===0){const t=new Set;return(Array.isArray(r.genres)?r.genres:[]).forEach(o=>{const i=(typeof o=="string"?o:o.id||"").toLowerCase();(T[i]||[]).forEach(s=>t.add(y(s)))}),Array.from(t)}return r.moods||[]}function Q(r){return Array.isArray(r)?r.map(t=>I(t)):[]}const X=y,$=r=>String(r).toLowerCase().trim(),Z=Object.freeze(Object.defineProperty({__proto__:null,CANONICAL_GENRES:K,CANONICAL_MOODS:z,normalizeGameObject:I,normalizeGamesArray:Q,normalizeGenre:$,normalizeMood:X,normalizeMoodToCanonical:y,normalizeTimeKey:V},Symbol.toStringTag,{value:"Module"}));class h extends Error{constructor(t,e,o){super(e),this.type=t,this.details=o,this.name="SteamImportError"}}class w{static safeParseDate(t){if(!t)return null;try{const e=new Date(t);return isNaN(e.getTime())?(console.warn("Invalid date string:",t),null):e}catch(e){return console.warn("Date parsing error:",e),null}}static async retryWithBackoff(t,e=3,o=1e3){for(let i=1;i<=e;i++)try{return await t()}catch(a){if(i===e)throw a;const s=o*Math.pow(2,i-1),l=Math.random()*.1*s,c=s+l;console.warn(`Steam API attempt ${i} failed, retrying in ${Math.round(c)}ms:`,a),await new Promise(n=>setTimeout(n,c))}throw new Error("Max retries exceeded")}static async fetchOwnedGames(t,e){return this.retryWithBackoff(async()=>{var o;try{console.log("ðŸ” Using backend Steam proxy:",{steamId:t});const{apiFetch:i}=await P(()=>import("./index-db369dc9.js").then(c=>c.o),["assets/index-db369dc9.js","assets/index-2d935eec.css"]),a=await i(`api/steam/games/v2?steamId=${encodeURIComponent(t)}&apiKey=${encodeURIComponent(e)}`);if(!a.ok){const c=await a.json().catch(()=>({error:"Unknown error"}));throw a.status===400?new h("INVALID_STEAM_ID",c.message||"Invalid Steam ID","Please check your Steam ID"):a.status===401||a.status===403?new h("INVALID_API_KEY",c.message||"Invalid Steam API key","Please check your API key"):a.status===503?new h("STEAM_API_ERROR",c.message||"Steam API temporarily unavailable","Please try again later"):new Error(`Backend API error: ${a.status} - ${c.message||"Unknown error"}`)}const s=await a.json();console.log("ðŸ” Backend Steam proxy returned:",s);const l=((o=s.data)==null?void 0:o.games)||s.games||[];if(!Array.isArray(l))throw new h("INVALID_RESPONSE","Invalid response from backend API","Please try again");return l.filter(c=>c.name&&c.appid)}catch(i){throw i instanceof h?i:(console.error("ðŸ” Backend Steam proxy error:",i),new h("NETWORK_ERROR","Failed to connect to backend API","Please check your connection and try again"))}},3,1e3)}static async fetchGameDetails(t){return this.retryWithBackoff(async()=>{try{const e=`${this.STEAM_STORE_BASE}?appids=${t}&format=json`,a=(await(await fetch(e,{signal:AbortSignal.timeout(8e3)})).json())[t];return a&&a.success&&a.data?a.data:null}catch(e){return console.warn(`Failed to fetch details for app ${t}:`,e),null}},2,500)}static normalizeSteamGame(t,e){var d,p,m,u,g,x,E,D;const o=new Date,i=Math.floor(t.playtime_forever/60),a=t.rtime_last_played?new Date(t.rtime_last_played*1e3):void 0;let s="unplayed";i>0&&(i<2||i<20?s="playing":i>=40?s="completed":s="playing");const l=((d=e==null?void 0:e.genres)==null?void 0:d.map(v=>({id:String(v.id).toLowerCase(),name:v.description,description:v.description,icon:"ðŸŽ®",color:"#8b5cf6",tags:[v.description.toLowerCase()]})))||[],c=e!=null&&e.platforms?[...e.platforms.windows?[{id:"pc",name:"PC",code:"pc",isConnected:!1}]:[],...e.platforms.mac?[{id:"mac",name:"Mac",code:"mac",isConnected:!1}]:[],...e.platforms.linux?[{id:"linux",name:"Linux",code:"linux",isConnected:!1}]:[]]:[{id:"pc",name:"PC",code:"pc",isConnected:!1}];return I({title:t.name,description:(e==null?void 0:e.short_description)||(e==null?void 0:e.about_the_game)||"",backgroundImages:e!=null&&e.header_image?[e.header_image]:[],coverImage:`https://cdn.akamai.steamstatic.com/steam/apps/${t.appid}/header.jpg`,releaseDate:this.safeParseDate((p=e==null?void 0:e.release_date)==null?void 0:p.date)||o,developer:((m=e==null?void 0:e.developers)==null?void 0:m[0])||"",publisher:((u=e==null?void 0:e.publishers)==null?void 0:u[0])||"",genres:l,moods:[],platforms:c,emotionalTags:[],userRating:0,globalRating:((g=e==null?void 0:e.metacritic)==null?void 0:g.score)||0,playStatus:s,hoursPlayed:i,lastPlayed:a,addedAt:o,notes:"",isFavorite:!1,tags:this.extractTagsFromDetails(e),releaseYear:((E=this.safeParseDate((x=e==null?void 0:e.release_date)==null?void 0:x.date))==null?void 0:E.getFullYear())||o.getFullYear(),achievements:e!=null&&e.achievements?{unlocked:0,total:((D=e==null?void 0:e.achievements)==null?void 0:D.total)||0}:void 0,totalPlaytime:i*60,averagePlaytime:0,completionRate:0,completionPercentage:0,launcherId:t.appid,lastLocalPlayedAt:null,localSessionMinutes:0,localSessionCount:0})}static extractTagsFromDetails(t){if(!t)return[];const e=[];return t.categories&&t.categories.forEach(o=>{const i=o.description.toLowerCase();(i.includes("multiplayer")||i.includes("co-op"))&&e.push("multiplayer"),i.includes("single-player")&&e.push("single-player"),i.includes("steam")&&e.push("steam"),i.includes("achievement")&&e.push("achievements"),i.includes("trading cards")&&e.push("trading")}),t.genres&&t.genres.forEach(o=>{const i=o.description.toLowerCase();i.includes("action")&&e.push("action"),i.includes("adventure")&&e.push("adventure"),i.includes("rpg")&&e.push("rpg"),i.includes("strategy")&&e.push("strategy"),i.includes("simulation")&&e.push("simulation"),i.includes("sports")&&e.push("sports"),i.includes("racing")&&e.push("racing")}),t.is_free&&e.push("free-to-play"),[...new Set(e)]}static async importSteamLibrary(t,e){try{const o=await R(`api/steam/library/${encodeURIComponent(t)}`);if(!o.ok)throw new Error(`Backend API error: ${o.status}`);const i=await o.json();return i.games&&Array.isArray(i.games)?i.games.map(a=>{var u;const s=a.appid||a.appId||a.steamAppId,l=a.imgLogoUrl||a.imgHeaderUrl||a.coverImage||`https://cdn.akamai.steamstatic.com/steam/apps/${s}/header.jpg`||`https://cdn.akamai.steamstatic.com/steam/apps/${s}/library_600x900.jpg`||`https://cdn.akamai.steamstatic.com/steam/apps/${s}/capsule_184x69.jpg`,c=a.categories||[];let n=c.map(g=>g.description).filter(Boolean);if(c.some(g=>g.description.toLowerCase().includes("multiplayer"))&&n.push("Multiplayer"),c.some(g=>g.description.toLowerCase().includes("single-player"))&&n.push("Single Player"),c.some(g=>g.description.toLowerCase().includes("co-op"))&&n.push("Co-op"),n.length===0){const g=a.name.toLowerCase();(g.includes("zombie")||g.includes("dead")||g.includes("resident evil"))&&n.push("Horror","Survival"),(g.includes("rpg")||g.includes("witcher")||g.includes("elder scrolls"))&&n.push("RPG"),(g.includes("shooter")||g.includes("counter-strike")||g.includes("call of duty"))&&n.push("Shooter"),(g.includes("strategy")||g.includes("command")||g.includes("company of heroes"))&&n.push("Strategy"),(g.includes("racing")||g.includes("rocket league"))&&n.push("Racing"),(g.includes("sports")||g.includes("football")||g.includes("wwe"))&&n.push("Sports"),(g.includes("adventure")||g.includes("tomb")||g.includes("assassin"))&&n.push("Adventure"),(g.includes("puzzle")||g.includes("portal"))&&n.push("Puzzle"),(g.includes("simulation")||g.includes("simulator"))&&n.push("Simulation"),n.length===0&&n.push("Action")}const d=c.slice(0,3).map(g=>({id:String(g.id).toLowerCase(),name:g.description,description:g.description,icon:"ðŸŽ®",color:"#8b5cf6",tags:[g.description.toLowerCase()]})),p=Math.floor((a.playtimeForever||0)/60);let m="unplayed";return p>0&&(p<2||p<20?m="playing":p>=40?m="completed":m="playing"),{title:a.name,description:a.shortDescription||"",backgroundImages:a.backgroundImages||[],coverImage:l,releaseDate:this.safeParseDate(a.releaseDate)||new Date,developer:a.developer||"",publisher:a.publisher||"",genres:d,moods:[],platforms:[{id:"steam",name:"Steam",code:"steam",isConnected:!0}],emotionalTags:[],userRating:void 0,globalRating:a.metacriticScore?a.metacriticScore:void 0,playStatus:m,hoursPlayed:p,lastPlayed:a.lastPlayed?new Date(a.lastPlayed):void 0,addedAt:new Date,notes:"",isFavorite:!1,tags:n,releaseYear:((u=this.safeParseDate(a.releaseDate))==null?void 0:u.getFullYear())||new Date().getFullYear(),achievements:a.achievements?{unlocked:a.achievements.unlocked||0,total:a.achievements.total||0}:void 0,totalPlaytime:p,averageRating:void 0,completionPercentage:void 0,appId:s}}):[]}catch(o){return console.error("Failed to import Steam library via backend:",o),[]}}}b(w,"STEAM_API_BASE","https://api.steampowered.com/IPlayerService/GetOwnedGames/v0001/"),b(w,"STEAM_STORE_BASE","https://store.steampowered.com/api/appdetails/"),b(w,"BACKUP_API_BASE","/api/steam");class ee{constructor(){}getAuthHeaders(){return{Accept:"application/json"}}async makeRequest(t,e={}){const o=await R(t,{...e,headers:{...this.getAuthHeaders(),...e.headers}});if(!o.ok){const i=await o.json().catch(()=>({}));throw new Error(i.error||`HTTP ${o.status}: ${o.statusText}`)}return o.json()}async getUserGames(){try{return await this.makeRequest("api/games/user")}catch(t){return console.error("GameApiService: getUserGames error:",t),{success:!1,error:t instanceof Error?t.message:"Unknown error"}}}async upsertGames(t){try{return await this.makeRequest("api/games/bulk",{method:"POST",body:JSON.stringify({games:t})})}catch(e){return console.error("GameApiService: upsertGames error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async launchGame(t,e){try{return await this.makeRequest("api/launcher/launch",{method:"POST",body:JSON.stringify({gameId:t,platformCode:e})})}catch(o){return console.error("GameApiService: launchGame error:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error"}}}async endSession(t){try{return await this.makeRequest("api/launcher/end-session",{method:"POST",body:JSON.stringify({sessionId:t})})}catch(e){return console.error("GameApiService: endSession error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}}const re=new ee,L="gamepilot_library",f=r=>{try{localStorage.setItem(L,JSON.stringify(r)),console.log("ðŸ’¾ Library saved to localStorage as backup")}catch(t){console.warn("Failed to save library to localStorage:",t)}},M=()=>{try{const r=localStorage.getItem(L);if(r){const t=JSON.parse(r);return console.log("ðŸ“‚ Library loaded from localStorage backup:",t.length),t}}catch(r){console.warn("Failed to load library from localStorage:",r)}return null},te=async(r,t,e=!1)=>{const{setIsLoading:o}=A.getState(),{setGames:i}=A.getState().actions;let a=[];try{o(!0),console.log("ðŸ” useLibraryStore: Calling SteamService.fetchOwnedGames with:",{steamId:r,apiKey:t,forceReimport:e});const s=await w.fetchOwnedGames(r,t);console.log("ðŸ” useLibraryStore: SteamService returned:",s),console.log("ðŸ” useLibraryStore: Number of games from Steam API:",s.length);const l=s.map(c=>{var d;const n=H(c);return console.log("ðŸ” Steam Import - Game:",(n==null?void 0:n.title)||(n==null?void 0:n.name)||"Unknown"),console.log("ðŸ” Steam Import - Assigned moods:",(n==null?void 0:n.moods)||[]),console.log("ðŸ” Steam Import - Genres:",((d=n==null?void 0:n.genres)==null?void 0:d.map(p=>typeof p=="string"?p:p.name))||[]),{...n,id:void 0}});console.log("ðŸ” useLibraryStore: Upserting games to database via API");try{const{apiFetch:c}=await P(()=>import("./index-db369dc9.js").then(p=>p.o),["assets/index-db369dc9.js","assets/index-2d935eec.css"]);console.log("ðŸ” useLibraryStore: About to call apiFetch with gamesForUpsert length:",l.length),console.log("ðŸ” useLibraryStore: First game sample:",JSON.stringify(l[0],null,2));const n=await c("launcher/upsert-games",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});console.log("ðŸ” useLibraryStore: API response status:",n.status),console.log("ðŸ” useLibraryStore: API response ok:",n.ok);const d=await n.json();if(console.log("ðŸ” useLibraryStore: API response result:",d),d.success&&d.data){const p=d.data.games;console.log("ðŸ” useLibraryStore: Successfully saved games to database:",p.length),a=[...a,...p],localStorage.setItem("games_library",JSON.stringify(a)),console.log("ðŸ” useLibraryStore: Games saved to database and localStorage:",a.length)}else throw console.warn("ðŸ” useLibraryStore: Database save failed, result:",d),new Error(d.error||"Database save failed")}catch(c){console.warn("ðŸ” useLibraryStore: API call failed, detailed error:",c),console.warn("ðŸ” useLibraryStore: API error type:",typeof c),c instanceof Error&&(console.warn("ðŸ” useLibraryStore: API error message:",c.message),console.warn("ðŸ” useLibraryStore: API error stack:",c.stack));const n=l.map(d=>({id:`local_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:d.title||d.name,description:d.description,coverImage:d.coverImage||d.cover,backgroundImages:d.backgroundImages||(d.background?[d.background]:[]),developer:null,publisher:null,genres:d.genres||[],subgenres:[],platforms:d.platforms||[],emotionalTags:d.emotionalTags||[],userRating:null,globalRating:null,playStatus:"backlog",hoursPlayed:d.hoursPlayed||0,addedAt:new Date().toISOString(),notes:null,isFavorite:!1,tags:[],moods:d.moods||[],playHistory:[],releaseYear:d.releaseYear||new Date().getFullYear(),achievements:{},totalPlaytime:null,averageRating:null,completionPercentage:null,appId:d.appid||d.id}));a=[...a,...n],localStorage.setItem("games_library",JSON.stringify(a)),console.log("ðŸ” useLibraryStore: Games saved locally as fallback:",n.length)}return{success:a.length>0,gameCount:a.length,games:a}}catch(s){throw console.error("ðŸ” useLibraryStore: Steam import failed:",s),s instanceof Error?(console.error("ðŸ” useLibraryStore: Error message:",s.message),console.error("ðŸ” useLibraryStore: Error stack:",s.stack)):typeof s=="object"&&s!==null?console.error("ðŸ” useLibraryStore: Error object details:",JSON.stringify(s,null,2)):console.error("ðŸ” useLibraryStore: Error type:",typeof s,"value:",s),new Error(s instanceof Error?s.message:typeof s=="string"?s:"Steam import failed: Unknown error")}finally{o(!1),a.length>0&&(console.log("ðŸ” useLibraryStore: Setting games in store:",a.length),i(a))}},A=U()((r,t)=>({games:[],currentSession:null,isLoading:!1,hasLoaded:!1,filters:{genre:null,platform:null,status:null,search:""},intelligence:{selectedMood:"",selectedMasterMood:"",selectedSessionLength:"",selectedGenres:[],selectedSorting:"",preferredGenres:[],preferredMoods:[],preferredSessionStyle:null},setIsLoading:e=>r({isLoading:e}),setHasLoaded:e=>r({hasLoaded:e}),setGames:e=>r({games:e,hasLoaded:!0}),actions:{addGame:e=>{r(o=>{const i=o.games.find(l=>l.id===e.id),a=o.games.find(l=>l.appId===e.appId);if(i||a)return o;const s=[...o.games,e];return f(s),{games:s}})},removeGame:e=>{r(o=>{const i=o.games.filter(a=>a.id!==e);return f(i),{games:i}})},updateGame:(e,o)=>{r(i=>{const a=i.games.map(s=>s.id===e?{...s,...o}:s);return f(a),{games:a}})},bulkUpdateStatus:(e,o)=>{r(i=>({games:i.games.map(a=>e.includes(a.id)?{...a,playStatus:o}:a)}))},bulkExport:()=>{const e=JSON.stringify(t().games,null,2),o=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(o),a=document.createElement("a");a.href=i,a.download="game-library.json",a.click(),URL.revokeObjectURL(i)},bulkImport:e=>{const o=e.map(i=>({...i,id:crypto.randomUUID(),addedAt:new Date}));r(i=>({games:[...i.games,...o]}))},importSteamLibrary:te,bulkAddToCategory:(e,o)=>{r(i=>({games:i.games.map(a=>e.includes(a.id)?{...a,tags:Array.from(new Set([...a.tags||[],o]))}:a)}))},deduplicateGames:()=>{r(e=>({games:e.games.filter((i,a,s)=>a===s.findIndex(l=>l.title.toLowerCase()===i.title.toLowerCase()))}))},bulkDelete:e=>{r(o=>({games:o.games.filter(i=>!e.includes(i.id))}))},launchGame:async e=>{console.log("ðŸ”§ Frontend Store - launchGame called with gameId:",e),console.log("ðŸ”§ DEBUG: Store games count:",t().games.length),console.log("ðŸ”§ DEBUG: Sample game IDs:",t().games.slice(0,3).map(s=>({id:s.id,appId:s.appId,title:s.title})));let o=t().games.find(s=>s.id===e);if(!o&&(console.log("ðŸ”§ Frontend Store - Game not found by ID, trying appId lookup"),o=t().games.find(s=>{var l;return((l=s.appId)==null?void 0:l.toString())===e}),!o)){console.log("ðŸ”§ DEBUG: Game not found, checking all games..."),t().games.forEach((s,l)=>{l<5&&console.log(`ðŸ”§ DEBUG: Game ${l}: id=${s.id}, appId=${s.appId}, title=${s.title}`)}),console.error("ðŸ”§ Frontend Store - Game not found at all!");return}const a=o.platforms.find(s=>s.code==="steam")?"steam":void 0;console.log("ðŸ”§ Frontend Store - About to call personaEngineService.launchGameWithPersonaTracking"),console.log("ðŸ”§ Frontend Store - Game data:",o.title,o.appId);try{const s=await _.launchGameWithPersonaTracking(e,o);console.log("ðŸ”§ Frontend Store - Persona engine result:",s),s.success&&s.data&&r({currentSession:{gameId:o.id,startedAt:Date.now()}})}catch(s){console.error("ðŸ”§ Frontend Store - Persona engine failed:",s);try{console.log("ðŸ”§ Frontend Store - Trying fallback launcher service");const l=await G.launchGame(e,a);console.log("ðŸ”§ Frontend Store - Launcher service result:",l),l.success&&l.data&&r({currentSession:{gameId:o.id,startedAt:Date.now()}})}catch(l){console.error("ðŸ”§ Frontend Store - Fallback launch also failed:",l)}}},endCurrentSession:async()=>{const e=t();if(e.currentSession)try{await _.endSessionWithPersonaTracking(void 0,e.currentSession.gameId);const o=Date.now()-e.currentSession.startedAt,i=Math.floor(o/6e4);r(a=>({games:a.games.map(s=>{var l;return s.id===((l=a.currentSession)==null?void 0:l.gameId)?{...s,hoursPlayed:(s.hoursPlayed||0)+i/60,lastPlayed:new Date}:s}),currentSession:null}))}catch(o){console.error("Failed to end session with persona tracking:",o);try{await G.endSession(void 0,e.currentSession.gameId);const i=Date.now()-e.currentSession.startedAt,a=Math.floor(i/6e4);r(s=>({games:s.games.map(l=>{var c;return l.id===((c=s.currentSession)==null?void 0:c.gameId)?{...l,hoursPlayed:(l.hoursPlayed||0)+a/60,lastPlayed:new Date}:l}),currentSession:null}))}catch(i){console.error("Fallback session end also failed:",i),r({currentSession:null})}}},setFilter:(e,o)=>{r(i=>({filters:{...i.filters,[e]:o}}))},clearFilters:()=>{r({filters:{genre:null,platform:null,status:null,search:""}})},setGames:e=>{const o=e.map(i=>({...i,tags:i.tags||[]}));r({games:o,hasLoaded:!0}),f(o)},updateGameStatus:(e,o)=>{r(i=>({games:i.games.map(a=>a.id===e?{...a,playStatus:o}:a)}))},updateGamePlaytime:(e,o)=>{r(i=>({games:i.games.map(a=>a.id===e?{...a,hoursPlayed:o}:a)}))},setHasLoaded:e=>r({hasLoaded:e}),clearCacheAndRefresh:async()=>{console.log("ðŸ§¹ Clearing cache and refreshing..."),localStorage.removeItem(L),console.log("ðŸ—‘ï¸ localStorage cleared"),r({games:[],hasLoaded:!1,isLoading:!1,currentSession:null}),await t().actions.loadGames(!0),console.log("ðŸ”„ Fresh data loaded from API")},loadGames:async(e=!1)=>{if(!e&&t().hasLoaded){console.log("ðŸŽ® Library already loaded, skipping...");return}try{t().setIsLoading(!0),console.log("ðŸ” Store: Calling getUserGames API...");const o=await re.getUserGames();if(console.log("ðŸ” Store: API response:",o),o.success&&o.data){o.data.games&&o.data.games.length>0&&console.log("ðŸ” Raw game object from API:",JSON.stringify(o.data.games[0],null,2));const i=o.data.games.map(l=>{var c;return{...l,name:l.title||l.name,steamData:{short_description:l.description,genres:((c=l.genres)==null?void 0:c.map(n=>typeof n=="object"&&n.description?{description:n.description}:typeof n=="string"?{description:n}:{description:String(n)}))||[],categories:l.categories||[],steam_appid:l.appId}}}),{normalizeGamesArray:a}=await P(()=>Promise.resolve().then(()=>Z),void 0),s=a(i);t().actions.setGames(s),f(s),console.log("ðŸŽ® Loaded and normalized user games:",s.length),console.log("ðŸ’¾ Fresh API data saved to localStorage")}else{console.error("Failed to load user games:",o.error);const i=M();i&&i.length>0&&(console.log("âš ï¸ Using localStorage fallback due to API failure"),t().actions.setGames(i))}t().setHasLoaded(!0)}catch(o){console.error("Failed to load games:",o);const i=M();i&&i.length>0?(t().actions.setGames(i),console.log("ðŸŽ® Loaded games from localStorage fallback after error:",i.length)):t().actions.setGames([]),t().setHasLoaded(!0)}finally{t().setIsLoading(!1)}}},setIntelligenceState:e=>{r(o=>({intelligence:{...o.intelligence,...e}}))}})),ae=(r,t)=>{console.log("ðŸ” Filter Debug - Selected mood:",t),console.log("ðŸ” Filter Debug - Available games:",r.length);const e=r.filter(o=>{var a;const i=o.moods&&o.moods.length>0&&o.moods.includes(t);return console.log(`ðŸ” Filter Debug - Game "${o.title}":`,{moods:o.moods,hasMood:i,genres:((a=o.genres)==null?void 0:a.map(s=>s.name))||[]}),i});return console.log("ðŸ” Filter Debug - Filtered games:",e.length),e},oe=(r,t)=>{console.log("ðŸ” Filter Debug - Selected genre:",t),console.log("ðŸ” Filter Debug - Available games:",r.length);const e=r.filter(o=>{var a;const i=o.genres&&o.genres.length>0&&o.genres.some(s=>(typeof s=="string"?s:s.name).toLowerCase()===t.toLowerCase());return console.log(`ðŸ” Filter Debug - Game "${o.title}":`,{genres:((a=o.genres)==null?void 0:a.map(s=>typeof s=="string"?s:s.name))||[],hasGenre:i}),i});return console.log("ðŸ” Filter Debug - Filtered games:",e.length),e},ie=(r,t)=>r.filter(e=>e.platforms.some(o=>o.name.toLowerCase()===t.toLowerCase())),se=(r,t)=>r.filter(e=>e.playStatus===t),ne=(r,t)=>{const e=t.toLowerCase();return r.filter(o=>{var i,a;return o.title.toLowerCase().includes(e)||((i=o.description)==null?void 0:i.toLowerCase().includes(e))||((a=o.tags)==null?void 0:a.some(s=>s.toLowerCase().includes(e)))})},le=(r,t,e,o)=>{const i=a=>{let s=0;if(t.length>0){const l=Array.isArray(a.genres)?a.genres:[];t.some(n=>l.some(d=>(typeof d=="string"?d:d.name||d.description||"").toLowerCase()===n.toLowerCase()))&&(s+=30)}if(e.length>0){const l=Array.isArray(a.moods)?a.moods:[];e.some(n=>l.some(d=>(typeof d=="string"?d:d.name||d.moodId||"").toLowerCase()===n.toLowerCase()))&&(s+=40)}if(s+=a.globalRating||0,a.lastPlayed){const l=new Date(a.lastPlayed).getTime();(Date.now()-l)/(1e3*60*60*24)<7&&(s+=20)}return s};return[...r].map(a=>({game:a,score:i(a)})).sort((a,s)=>s.score-a.score).map(a=>a.game)},ce=r=>[...r].sort((t,e)=>{if((e.globalRating||0)!==(t.globalRating||0))return(e.globalRating||0)-(t.globalRating||0);const o=t.lastPlayed?new Date(t.lastPlayed).getTime():0;return(e.lastPlayed?new Date(e.lastPlayed).getTime():0)-o}),ue=Object.freeze(Object.defineProperty({__proto__:null,filterByGenre:oe,filterByMood:ae,filterByPlatform:ie,filterByStatus:se,getRecommendedGames:le,getTrendingGames:ce,searchGames:ne,useLibraryStore:A},Symbol.toStringTag,{value:"Module"}));export{T as G,pe as a,B as b,me as c,Z as d,ue as e,Q as n,A as u};
